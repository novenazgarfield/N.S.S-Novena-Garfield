<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>NEXUS Research Workstation - N.S.S Novena Garfield</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <!-- Cache buster: 20250826-112000 -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* æ·±è‰²ä¸»é¢˜è‰²å½© - æŒ‰ç…§æˆªå›¾é£æ ¼ */
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-card: #3a3a3a;
            --bg-hover: #4a4a4a;
            
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-muted: #808080;
            
            --accent-blue: #4a9eff;
            --accent-green: #4ade80;
            --accent-red: #ef4444;
            --accent-orange: #f97316;
            --accent-purple: #8b5cf6;
            --accent-cyan: #06b6d4;
            
            --border-color: #404040;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            
            --status-online: #22c55e;
            --status-offline: #ef4444;
            
            /* åŠ¨æ€é«˜åº¦å˜é‡ */
            --app-height: 100vh;
            --real-vh: 1vh; /* çœŸå®è§†çª—é«˜åº¦å•ä½ï¼Œå°†é€šè¿‡JSåŠ¨æ€è®¾ç½® */
            
            /* ç§»åŠ¨ç«¯ä¸“ç”¨å˜é‡ */
            --mobile-header-height: 60px;
            --mobile-nav-height: 60px;
            --mobile-padding: 16px;
            --mobile-card-gap: 12px;
            --touch-target-size: 44px;
            --mobile-font-size: 16px;
            --mobile-line-height: 1.4;
        }

        [data-theme="light"] {
            /* æµ…è‰²ä¸»é¢˜ */
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-card: #ffffff;
            --bg-hover: #e9ecef;
            
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --text-muted: #adb5bd;
            
            --border-color: #dee2e6;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, 'Noto Sans CJK SC', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            height: calc(var(--real-vh, 1vh) * 100); /* ä½¿ç”¨åŠ¨æ€è§†çª—é«˜åº¦ */
            overflow: hidden;
            margin: 0;
            padding: 0;
            transition: background-color 0.2s, color 0.2s;
        }







        .app-container {
            display: flex;
            height: calc(var(--real-vh, 1vh) * 100);
            width: 100vw;
            max-width: 100vw;
            overflow: hidden;
        }

        /* ä¾§è¾¹æ  */
        .sidebar {
            width: 280px !important;
            min-width: 280px !important;
            max-width: 280px !important;
            background: var(--bg-secondary);
            border-right: none;
            display: flex;
            flex-direction: column;
            transition: background-color 0.2s, border-color 0.2s;
            flex-shrink: 0 !important;
            box-sizing: border-box !important;
            overflow: hidden !important;
            position: relative;
        }

        .sidebar::after {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 1px;
            background: var(--border-color);
            transition: background-color 0.2s;
            z-index: 10;
            display: block;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            right: 0;
            bottom: 80px; /* æ¢å¤åˆ°åŸæ¥çš„ä½ç½® */
            width: 100vw; /* å»¶ä¼¸åˆ°å±å¹•å³è¾¹ */
            height: 1px;
            background: var(--border-color);
            transition: background-color 0.2s;
            z-index: 10;
            display: block;
        }

        


        /* ç»ˆæè¦†ç›–è§„åˆ™ - ç¡®ä¿åœ¨æ‰€æœ‰æƒ…å†µä¸‹ä¾§è¾¹æ å®½åº¦éƒ½æ˜¯280px */
        .sidebar,
        .sidebar[style],
        html .sidebar,
        body .sidebar,
        * .sidebar {
            width: 280px !important;
            min-width: 280px !important;
            max-width: 280px !important;
            flex-shrink: 0 !important;
            box-sizing: border-box !important;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            transition: border-color 0.2s;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: var(--accent-blue);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .logo-text {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .logo-subtitle {
            font-size: 12px;
            color: var(--text-muted);
            margin-left: 44px;
        }

        .sidebar-nav {
            flex: 1;
            padding: 20px 0;
            overflow-y: auto;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
            background: none;
            width: 100% !important; /* å¼ºåˆ¶å›ºå®šå®½åº¦ */
            max-width: 100% !important; /* é˜²æ­¢å†…å®¹æ’‘å¤§å¯¼èˆªé¡¹ */
            text-align: left;
            min-height: 48px; /* ä½¿ç”¨min-heightè€Œä¸æ˜¯å›ºå®šheightï¼Œé€‚åº”ä¸åŒè¯­è¨€æ–‡å­— */
            box-sizing: border-box !important; /* ç¡®ä¿paddingåŒ…å«åœ¨é«˜åº¦å†… */
            overflow: hidden !important; /* å¼ºåˆ¶éšè—æº¢å‡ºå†…å®¹ */
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, 'Noto Sans CJK SC', 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }

        .nav-item:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: var(--accent-blue);
            color: white;
            border-left: 3px solid var(--accent-blue);
            padding-left: 17px; /* è°ƒæ•´å·¦è¾¹è·ä»¥ä¿æŒå¯¹é½ */
        }

        .nav-item-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-item-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.3; /* ä¼˜åŒ–è¡Œé«˜é€‚åº”CJKæ–‡å­— */
            white-space: nowrap !important; /* é˜²æ­¢æ–‡æœ¬æ¢è¡Œ */
            overflow: hidden !important; /* éšè—æº¢å‡ºæ–‡æœ¬ */
            text-overflow: ellipsis !important; /* é•¿æ–‡æœ¬æ˜¾ç¤ºçœç•¥å· */
            min-width: 0 !important; /* å…è®¸flexé¡¹ç›®æ”¶ç¼© */
            max-width: 140px !important; /* æ›´å°çš„æ–‡æœ¬å®½åº¦é™åˆ¶ */
            width: 140px !important; /* å›ºå®šæ›´å°çš„æ–‡æœ¬åŒºåŸŸå®½åº¦ */
            font-weight: 500; /* ç»Ÿä¸€å­—ä½“ç²—ç»† */
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, 'Noto Sans CJK SC', 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        
        /* ç»Ÿä¸€ä¸­è‹±æ—¥æ–‡å­—ä½“é…ç½® */
        [lang="ja-JP"] .nav-item-text,
        [lang="en-US"] .nav-item-text,
        [lang="zh-CN"] .nav-item-text {
            font-weight: 500; /* ç»Ÿä¸€å­—ä½“ç²—ç»† */
            line-height: 1.3; /* ç»Ÿä¸€è¡Œé«˜ */
            letter-spacing: normal; /* ç»Ÿä¸€å­—ç¬¦é—´è· */
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, 'Noto Sans CJK SC', 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        
        [lang="ja-JP"] .nav-item,
        [lang="en-US"] .nav-item,
        [lang="zh-CN"] .nav-item {
            /* ç»Ÿä¸€å¯¼èˆªé¡¹æ ·å¼ */
        }
        
        [lang="ja-JP"] .page-title,
        [lang="en-US"] .page-title,
        [lang="zh-CN"] .page-title {
            font-weight: 500; /* ç»Ÿä¸€æ ‡é¢˜å­—ä½“ç²—ç»† */
            line-height: 1.3;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, 'Noto Sans CJK SC', 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--status-offline);
            margin-left: auto;
            margin-right: 4px;
        }

        .status-indicator.online {
            background: var(--status-online);
        }

        .sidebar-footer {
            padding: 20px;
            padding-bottom: 14px; /* å¾®è°ƒå›åˆ°ä¸­é—´å€¼ï¼Œå¯»æ‰¾å®Œç¾å¯¹é½ç‚¹ */
            transition: border-color 0.2s;
            /* ç¡®ä¿è®¾ç½®æŒ‰é’®ä¸è¾“å…¥æ¡†åº•éƒ¨å¯¹é½ */
            margin-top: auto;
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative; /* ä¸ºRAGç•Œé¢çš„ç»å¯¹å®šä½æä¾›å‚è€ƒ */
            transition: background-color 0.2s;
        }

        .header {
            height: 60px;
            min-height: 60px; /* ç¡®ä¿æœ€å°é«˜åº¦ */
            max-height: 60px; /* ç¡®ä¿æœ€å¤§é«˜åº¦ */
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            box-sizing: border-box; /* ç¡®ä¿paddingåŒ…å«åœ¨é«˜åº¦å†… */
            transition: background-color 0.2s, border-color 0.2s;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 8px;
            height: 100%; /* å æ»¡headeré«˜åº¦ */
        }

        .back-btn {
            width: 36px;
            height: 36px;
            background: var(--bg-card);
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .back-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .page-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            min-width: 120px; /* è®¾ç½®æœ€å°å®½åº¦ç¡®ä¿ä¸€è‡´æ€§ */
            white-space: nowrap; /* é˜²æ­¢æ ‡é¢˜æ¢è¡Œ */
            overflow: hidden; /* éšè—æº¢å‡ºæ–‡æœ¬ */
            text-overflow: ellipsis; /* é•¿æ ‡é¢˜æ˜¾ç¤ºçœç•¥å· */
            line-height: 1.2; /* å›ºå®šè¡Œé«˜ç¡®ä¿ä¸€è‡´æ€§ */
            margin: 0; /* ç§»é™¤é»˜è®¤margin */
            padding: 0; /* ç§»é™¤é»˜è®¤padding */
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
            height: 100%; /* å æ»¡headeré«˜åº¦ */
        }

        .header-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: var(--bg-card);
            color: var(--text-secondary);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .header-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .theme-toggle-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: var(--bg-card);
            color: var(--text-secondary);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 16px;
        }

        .theme-toggle-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .content {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
        }

        /* å¡ç‰‡ç½‘æ ¼ */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 24px;
            max-width: 1200px;
        }

        .project-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 24px;
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }

        .project-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .card-icon.nexus { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .card-icon.rag { background: linear-gradient(135deg, #06b6d4, #0891b2); }
        .card-icon.platform { background: linear-gradient(135deg, #22c55e, #16a34a); }

        .card-info h3 {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
            transition: color 0.2s;
        }

        .card-info p {
            font-size: 12px;
            color: var(--text-muted);
            transition: color 0.2s;
        }

        .card-description {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 20px;
            transition: color 0.2s;
        }

        .card-features {
            margin-bottom: 20px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 13px;
            color: var(--text-secondary);
            transition: color 0.2s;
        }

        .feature-check {
            color: var(--status-online);
        }

        .card-actions {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 10px 16px;
            border-radius: 8px;
            border: none;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
        }

        .btn-primary:hover {
            background: #3b82f6;
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        /* RAG èŠå¤©ç•Œé¢ */
        .rag-chat {
            display: none;
            height: calc(var(--real-vh, 1vh) * 100 - 60px); /* ä½¿ç”¨åŠ¨æ€è§†çª—é«˜åº¦å‡å»headeré«˜åº¦ */
            flex-direction: column;
            position: absolute;
            top: 60px; /* headeré«˜åº¦ */
            left: 0;
            right: 0;
            bottom: 0;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            min-height: 0; /* é‡è¦ï¼šç¡®ä¿flexå­å…ƒç´ å¯ä»¥æ”¶ç¼© */
        }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ - ç»Ÿä¸€åº”ç”¨åˆ°æ‰€æœ‰æ»šåŠ¨åŒºåŸŸ */
        .chat-messages::-webkit-scrollbar,
        .sidebar-nav::-webkit-scrollbar,
        .content::-webkit-scrollbar,
        .settings-page::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track,
        .sidebar-nav::-webkit-scrollbar-track,
        .content::-webkit-scrollbar-track,
        .settings-page::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-messages::-webkit-scrollbar-thumb,
        .sidebar-nav::-webkit-scrollbar-thumb,
        .content::-webkit-scrollbar-thumb,
        .settings-page::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
            opacity: 0.3;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover,
        .sidebar-nav::-webkit-scrollbar-thumb:hover,
        .content::-webkit-scrollbar-thumb:hover,
        .settings-page::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        .message {
            margin-bottom: 16px;
            display: flex;
            gap: 12px;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--accent-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .message.user .message-avatar {
            background: var(--accent-green);
        }

        .message-content {
            background: var(--bg-card);
            padding: 12px 16px;
            border-radius: 12px;
            max-width: 70%;
            font-size: 14px;
            line-height: 1.4;
        }

        .message.user .message-content {
            background: var(--accent-blue);
            color: white;
        }

        .chat-input {
            padding: 20px;
            background: var(--bg-secondary);
            transition: background-color 0.2s, border-color 0.2s;
            position: relative;
        }

        .input-group {
            display: flex;
            gap: 12px;
            align-items: center;
            margin: 0 auto;
            max-width: calc(100% - 16px); /* å·¦å³å„ç•™8px */
        }

        .chat-input-field {
            flex: 1;
            padding: 10px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            height: 40px; /* å‡å°‘é«˜åº¦ */
            box-sizing: border-box;
        }

        .chat-input-field:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .send-btn {
            padding: 10px 20px;
            background: var(--accent-blue);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            height: 40px; /* ä¸è¾“å…¥æ¡†ç›¸åŒé«˜åº¦ */
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .send-btn:hover {
            background: #3b82f6;
        }

        /* åŠŸèƒ½æŒ‰é’®æ ·å¼ */
        .function-btn {
            width: 40px;
            height: 40px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            position: relative;
            flex-shrink: 0;
        }

        .function-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent-blue);
        }

        .function-btn.active {
            background: var(--accent-blue);
            border-color: var(--accent-blue);
        }

        .function-btn.active .function-icon {
            color: white;
        }

        .function-icon {
            font-size: 18px;
            transition: transform 0.2s ease;
        }

        .function-btn.active .function-icon {
            transform: rotate(180deg);
        }

        /* è¿æ¥çŠ¶æ€æ‚¬æµ®æ¡†æ ·å¼ */
        .connection-status {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
            min-width: 280px;
            max-width: 320px;
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(248, 250, 252, 0.95));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.08),
                0 8px 16px rgba(0, 0, 0, 0.04),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            font-size: 0.85em;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
            overflow: hidden;
        }

        .connection-status.show {
            transform: translateX(0);
            opacity: 1;
            pointer-events: auto;
        }

        .status-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px 12px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.06);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(248, 250, 252, 0.6));
        }

        .status-title {
            font-weight: 600;
            color: #1a202c;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-close {
            background: rgba(0, 0, 0, 0.04);
            border: none;
            color: #64748b;
            cursor: pointer;
            padding: 6px 8px;
            border-radius: 8px;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
            height: 24px;
        }

        .status-close:hover {
            background: rgba(239, 68, 68, 0.1);
            color: #dc2626;
            transform: scale(1.05);
        }

        .connection-status .status-content {
            display: flex;
            align-items: flex-start;
            gap: 14px;
            padding: 16px 20px;
        }

        .status-dot {
            font-size: 1.3em;
            animation: pulse 2s infinite;
            flex-shrink: 0;
            margin-top: 1px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .status-text {
            color: #374151;
            font-weight: 500;
            line-height: 1.5;
            flex: 1;
            word-break: break-word;
        }

        .status-details {
            padding: 12px 20px 16px;
            font-size: 0.8em;
            color: #6b7280;
            line-height: 1.5;
            white-space: pre-wrap;
            word-break: break-word;
            border-top: 1px solid rgba(0, 0, 0, 0.06);
            background: linear-gradient(135deg, rgba(248, 250, 252, 0.8), rgba(241, 245, 249, 0.6));
            border-radius: 0 0 16px 16px;
            font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
        }

        /* çŠ¶æ€åŠ¨ç”» */
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        /* ä¸åŒçŠ¶æ€çš„æ ·å¼ */
        .connection-status.connected {
            background: linear-gradient(145deg, rgba(236, 253, 245, 0.98), rgba(209, 250, 229, 0.95));
            border-color: rgba(16, 185, 129, 0.3);
            box-shadow: 
                0 20px 40px rgba(16, 185, 129, 0.08),
                0 8px 16px rgba(16, 185, 129, 0.04),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .connection-status.connected .status-header {
            background: linear-gradient(135deg, rgba(236, 253, 245, 0.9), rgba(220, 252, 231, 0.7));
        }

        .connection-status.connected .status-text {
            color: #065f46;
        }

        .connection-status.connected .status-details {
            color: #047857;
            background: linear-gradient(135deg, rgba(220, 252, 231, 0.8), rgba(209, 250, 229, 0.6));
        }

        .connection-status.error {
            background: linear-gradient(145deg, rgba(254, 242, 242, 0.98), rgba(252, 231, 243, 0.95));
            border-color: rgba(239, 68, 68, 0.3);
            box-shadow: 
                0 20px 40px rgba(239, 68, 68, 0.08),
                0 8px 16px rgba(239, 68, 68, 0.04),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .connection-status.error .status-header {
            background: linear-gradient(135deg, rgba(254, 242, 242, 0.9), rgba(252, 231, 243, 0.7));
        }

        .connection-status.error .status-text {
            color: #991b1b;
        }

        .connection-status.error .status-details {
            color: #b91c1c;
            background: linear-gradient(135deg, rgba(252, 231, 243, 0.8), rgba(254, 226, 226, 0.6));
        }

        .connection-status.warning {
            background: linear-gradient(145deg, rgba(255, 251, 235, 0.98), rgba(254, 243, 199, 0.95));
            border-color: rgba(245, 158, 11, 0.3);
            box-shadow: 
                0 20px 40px rgba(245, 158, 11, 0.08),
                0 8px 16px rgba(245, 158, 11, 0.04),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .connection-status.warning .status-header {
            background: linear-gradient(135deg, rgba(255, 251, 235, 0.9), rgba(254, 243, 199, 0.7));
        }

        .connection-status.warning .status-text {
            color: #92400e;
        }

        .connection-status.warning .status-details {
            color: #a16207;
            background: linear-gradient(135deg, rgba(254, 243, 199, 0.8), rgba(253, 230, 138, 0.6));
        }

        /* æš—è‰²ä¸»é¢˜é€‚é… */
        [data-theme="dark"] .connection-status {
            background: linear-gradient(145deg, rgba(31, 41, 55, 0.98), rgba(17, 24, 39, 0.95));
            border-color: rgba(75, 85, 99, 0.3);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.3),
                0 8px 16px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        [data-theme="dark"] .connection-status .status-header {
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.9), rgba(17, 24, 39, 0.7));
            border-bottom-color: rgba(75, 85, 99, 0.2);
        }

        [data-theme="dark"] .connection-status .status-title {
            color: #f9fafb;
        }

        [data-theme="dark"] .connection-status .status-close {
            background: rgba(255, 255, 255, 0.1);
            color: #9ca3af;
        }

        [data-theme="dark"] .connection-status .status-close:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #f87171;
        }

        [data-theme="dark"] .connection-status .status-text {
            color: #e5e7eb;
        }

        [data-theme="dark"] .connection-status .status-details {
            color: #9ca3af;
            background: linear-gradient(135deg, rgba(17, 24, 39, 0.8), rgba(31, 41, 55, 0.6));
            border-top-color: rgba(75, 85, 99, 0.2);
        }

        [data-theme="dark"] .connection-status.connected {
            background: linear-gradient(145deg, rgba(6, 78, 59, 0.98), rgba(4, 120, 87, 0.95));
            border-color: rgba(16, 185, 129, 0.4);
        }

        [data-theme="dark"] .connection-status.connected .status-header {
            background: linear-gradient(135deg, rgba(6, 78, 59, 0.9), rgba(4, 120, 87, 0.7));
        }

        [data-theme="dark"] .connection-status.error {
            background: linear-gradient(145deg, rgba(127, 29, 29, 0.98), rgba(153, 27, 27, 0.95));
            border-color: rgba(239, 68, 68, 0.4);
        }

        [data-theme="dark"] .connection-status.error .status-header {
            background: linear-gradient(135deg, rgba(127, 29, 29, 0.9), rgba(153, 27, 27, 0.7));
        }

        [data-theme="dark"] .connection-status.warning {
            background: linear-gradient(145deg, rgba(146, 64, 14, 0.98), rgba(161, 98, 7, 0.95));
            border-color: rgba(245, 158, 11, 0.4);
        }

        [data-theme="dark"] .connection-status.warning .status-header {
            background: linear-gradient(135deg, rgba(146, 64, 14, 0.9), rgba(161, 98, 7, 0.7));
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            .connection-status {
                top: 70px;
                right: 10px;
                left: 10px;
                min-width: auto;
                max-width: none;
            }
        }

        /* åŠŸèƒ½èœå•æ ·å¼ */
        .function-menu {
            position: absolute;
            bottom: calc(100% + 8px);
            left: 0;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            min-width: 180px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.2s ease;
            z-index: 1000;
        }

        .function-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .function-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border-radius: 8px;
            margin: 4px;
        }

        .function-item:hover {
            background: var(--bg-hover);
        }

        .function-item-icon {
            font-size: 16px;
            width: 20px;
            text-align: center;
        }

        .function-item-text {
            font-size: 14px;
            color: var(--text-primary);
            white-space: nowrap;
        }

        /* è®¾ç½®é¡µé¢æ ·å¼ */
        .settings-page {
            display: none;
            height: 100%;
            overflow-y: auto;
        }

        .settings-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 24px;
        }

        .settings-section {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid var(--border-color);
            transition: background-color 0.2s, border-color 0.2s;
        }

        .settings-section h3 {
            margin: 0 0 20px 0;
            color: var(--text-primary);
            font-size: 18px;
            font-weight: 600;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
            transition: border-color 0.2s;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-item label {
            color: var(--text-primary);
            font-weight: 500;
            font-size: 14px;
        }

        .setting-item select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 14px;
            min-width: 120px;
        }

        .setting-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-blue);
        }

        .version-info {
            color: var(--text-secondary);
            font-size: 14px;
            font-family: monospace;
        }

        /* ç©ºç™½é¡µé¢æ ·å¼ */
        .empty-page {
            display: none;
            height: 100%;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .empty-content {
            text-align: center;
            max-width: 400px;
            padding: 40px;
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .empty-content h3 {
            color: var(--text-primary);
            font-size: 24px;
            margin-bottom: 12px;
        }

        .empty-content p {
            color: var(--text-secondary);
            font-size: 16px;
            line-height: 1.5;
        }

        /* é¡¹ç›®ä¿¡æ¯é¡µé¢æ ·å¼ */
        .project-info-container {
            height: 100vh;
            overflow: visible;
            scroll-behavior: smooth;
        }

        /* é¡¹ç›®ä»‹ç»é¦–é¡µ - å…¨å±æ˜¾ç¤º */
        .project-hero {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 40px;
            position: relative;
        }

        .project-hero-title {
            margin-bottom: 40px;
            display: flex;
            align-items: baseline;
            justify-content: center;
            gap: 20px;
            flex-wrap: nowrap;
            white-space: nowrap;
        }

        .project-hero-title .rocket {
            font-size: 60px;
            color: var(--accent-blue);
            font-weight: 700;
        }

        .project-hero-title .nss-title {
            font-size: 60px;
            font-weight: 700;
            color: var(--accent-blue);
            letter-spacing: 6px;
        }

        .project-hero-title .novena-title {
            font-size: 60px;
            font-weight: 700;
            color: var(--accent-blue);
        }

        .project-hero h2 {
            font-size: 32px;
            font-weight: 500;
            color: var(--text-primary);
            margin: 0 0 40px 0;
        }

        .project-hero p {
            font-size: 18px;
            color: var(--text-secondary);
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
        }

        .scroll-indicator {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--text-muted);
            font-size: 14px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateX(-50%) translateY(0);
            }
            40% {
                transform: translateX(-50%) translateY(-10px);
            }
            60% {
                transform: translateX(-50%) translateY(-5px);
            }
        }

        .project-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 32px;
            padding: 24px 24px 16px 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .project-header h1 {
            color: var(--text-primary);
            font-size: 28px;
            font-weight: 600;
            margin: 0;
        }

        .back-btn {
            padding: 8px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .back-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent-blue);
        }

        .project-content {
            padding: 0 24px 24px 24px;
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        /* æŠ€æœ¯æ ˆå…¨å±é¡µé¢ */
        .tech-stack-hero {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 40px;
        }

        .tech-stack-hero h2 {
            font-size: 48px;
            font-weight: 700;
            color: var(--accent-blue);
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .tech-stack-hero .description {
            font-size: 20px;
            color: var(--text-secondary);
            line-height: 1.5;
            max-width: 800px;
            margin: 0 auto 40px auto;
        }

        .tech-stack-hero .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
            max-width: 1000px;
            width: 100%;
        }

        .tech-stack-hero .tech-item {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 16px 12px;
            font-size: 16px;
            font-weight: 500;
            color: var(--text-primary);
            transition: all 0.3s ease;
            text-align: center;
        }

        .tech-stack-hero .tech-item:hover {
            background: var(--bg-hover);
            border-color: var(--accent-blue);
            transform: translateY(-2px);
        }

        /* ä¸‹è½½é¡µé¢æ ·å¼ */
        .download-hero {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px;
            background: var(--bg-primary);
        }

        .download-container {
            max-width: 1000px;
            width: 100%;
            text-align: center;
            padding: 60px 40px;
        }

        .download-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .download-icon {
            font-size: 50px;
        }

        .download-header h2 {
            font-size: 50px;
            font-weight: 700;
            color: var(--accent-blue);
            margin: 0;
        }

        .download-description {
            font-size: 22px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 50px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .download-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 50px;
            flex-wrap: wrap;
        }

        .download-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px 30px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, #4a9eff 100%);
            border: none;
            border-radius: 15px;
            color: white;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            min-width: 260px;
            box-shadow: 0 8px 20px rgba(74, 158, 255, 0.3);
        }

        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(74, 158, 255, 0.4);
        }

        .download-btn .btn-icon {
            font-size: 28px;
        }

        .download-btn .btn-content {
            flex: 1;
            text-align: left;
        }

        .download-btn .btn-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .download-btn .btn-subtitle {
            font-size: 14px;
            opacity: 0.8;
        }

        .download-btn.linux .btn-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff6b35;
            color: white;
            font-size: 10px;
            padding: 4px 8px;
            border-radius: 8px;
            font-weight: 600;
        }

        .download-links {
            display: flex;
            gap: 25px;
            justify-content: center;
            margin-bottom: 50px;
            flex-wrap: nowrap;
        }

        .link-item {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s ease;
            white-space: nowrap;
        }

        .link-item:hover {
            color: var(--accent-blue);
        }

        .link-icon {
            font-size: 16px;
        }

        .download-footer {
            padding-top: 50px;
        }

        .download-footer::before {
            content: '';
            display: block;
            width: 80%;
            max-width: 600px;
            height: 1px;
            background: var(--border-color);
            margin: 0 auto 30px auto;
        }

        .download-footer p {
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.6;
            font-size: 16px;
        }

        .download-footer .copyright {
            font-size: 14px;
            opacity: 0.7;
            margin-top: 12px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .download-hero {
                padding: 40px 20px;
            }
            
            .download-container {
                padding: 40px 20px;
            }
            
            .download-header h2 {
                font-size: 40px;
            }
            
            .download-icon {
                font-size: 40px;
            }
            
            .download-description {
                font-size: 18px;
            }
            
            .download-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .download-btn {
                min-width: 300px;
            }
            
            .download-links {
                flex-wrap: wrap;
                gap: 20px;
            }
        }

        .project-section h2 {
            color: var(--text-primary);
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .project-section p {
            color: var(--text-secondary);
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .components-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .component-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            transition: all 0.2s;
        }

        .component-card:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .component-card h3 {
            color: var(--text-primary);
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .component-card p {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.5;
            margin: 0;
        }

        .features-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 12px;
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .features-list li {
            color: var(--text-secondary);
            font-size: 16px;
            padding: 8px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 16px;
        }

        .tech-tag {
            background: var(--accent-blue);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 14px;
            font-weight: 500;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .project-info-container {
                padding: 16px;
            }

            .project-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .project-header h1 {
                font-size: 24px;
            }

            .components-grid {
                grid-template-columns: 1fr;
            }

            .features-list {
                grid-template-columns: 1fr;
            }
        }

        /* ğŸŒ è¯­è¨€åˆ‡æ¢å™¨ */
        .language-switcher {
            position: relative;
            display: inline-block;
        }

        .language-switcher:hover {
            /* ç§»é™¤hoveræ•ˆæœï¼Œå› ä¸ºç°åœ¨æ˜¯æŒ‰é’®çº§åˆ«çš„hover */
        }

        .language-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            cursor: pointer;
            padding: 6px 10px;
            border-radius: 8px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
            min-width: 80px;
            height: 32px;
        }

        .language-btn:hover {
            background: var(--bg-hover);
        }

        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 4px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: var(--shadow);
            min-width: 120px;
            display: none;
            z-index: 1001;
        }

        .language-dropdown.show {
            display: block;
        }

        .language-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 14px;
            color: var(--text-primary);
        }

        .language-option:hover {
            background: var(--bg-hover);
        }

        .language-option:first-child {
            border-radius: 8px 8px 0 0;
        }

        .language-option:last-child {
            border-radius: 0 0 8px 8px;
        }

        .language-option.active {
            background: var(--accent-blue);
            color: white;
        }

        /* ğŸ“± ç§»åŠ¨ç«¯æ±‰å ¡èœå• */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 16px;
            left: 16px;
            z-index: 1002;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            width: 44px;
            height: 44px;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
            transition: all 0.2s;
        }

        .mobile-menu-btn:hover {
            background: var(--bg-hover);
        }

        .mobile-menu-btn span {
            display: block;
            width: 20px;
            height: 2px;
            background: var(--text-primary);
            margin: 3px 0;
            transition: 0.3s;
            border-radius: 1px;
        }

        .mobile-menu-btn.active span:nth-child(1) {
            transform: rotate(-45deg) translate(-5px, 6px);
        }

        .mobile-menu-btn.active span:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu-btn.active span:nth-child(3) {
            transform: rotate(45deg) translate(-5px, -6px);
        }

        /* ğŸ“± ç§»åŠ¨ç«¯é®ç½©å±‚ */
        .mobile-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .mobile-overlay.show {
            opacity: 1;
        }

        /* ğŸ“± å¹³æ¿ç«¯é€‚é… (768px - 1024px) */
        @media (max-width: 1024px) and (min-width: 769px) {
            .sidebar {
                width: 280px !important; /* å¼ºåˆ¶å›ºå®šå®½åº¦ */
                min-width: 280px !important;
                max-width: 280px !important;
            }
            
            .cards-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }
            
            .project-card {
                padding: 20px;
            }
            
            /* è¯­è¨€åˆ‡æ¢å™¨ç°åœ¨åœ¨headerä¸­ï¼Œä¸éœ€è¦å›ºå®šä½ç½® */
        }

        /* ğŸ“± ç§»åŠ¨ç«¯é€‚é… (æœ€å¤§768px) */
        @media (max-width: 768px) {
            /* å¯ç”¨ç§»åŠ¨ç«¯èœå• */
            .mobile-menu-btn {
                display: flex;
            }
            
            /* ä¾§è¾¹æ ç§»åŠ¨ç«¯æ ·å¼ */
            .sidebar {
                position: fixed;
                left: -280px;
                top: 0;
                width: 280px;
                height: calc(var(--real-vh, 1vh) * 100); /* ä½¿ç”¨åŠ¨æ€è§†çª—é«˜åº¦ */
                z-index: 1000;
                transition: left 0.3s ease;
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
            }

            .sidebar::after {
                right: 0;
                top: 0;
                bottom: 0;
                width: 1px;
                background: var(--border-color);
                z-index: 10;
                display: block;
            }

            .sidebar::before {
                right: 0;
                bottom: 80px;
                width: 100vw;
                height: 1px;
                background: var(--border-color);
                z-index: 10;
                display: block;
            }


            
            .sidebar.mobile-open {
                left: 0;
            }
            
            /* ä¸»å†…å®¹åŒºç§»åŠ¨ç«¯è°ƒæ•´ */
            .main-content {
                margin-left: 0;
                width: 100%;
            }
            
            /* å¤´éƒ¨ç§»åŠ¨ç«¯æ ·å¼ */
            .header {
                height: var(--mobile-header-height);
                padding: 0 var(--mobile-padding);
                padding-left: 70px; /* ä¸ºæ±‰å ¡èœå•ç•™ç©ºé—´ */
            }
            
            .page-title {
                font-size: 18px;
                min-width: 100px; /* ç§»åŠ¨ç«¯ç¨å°çš„æœ€å°å®½åº¦ */
            }
            
            .theme-toggle {
                width: 36px;
                height: 36px;
                font-size: 16px;
            }
            
            /* å†…å®¹åŒºç§»åŠ¨ç«¯æ ·å¼ */
            .content {
                padding: var(--mobile-padding);
            }
            
            /* å¡ç‰‡ç½‘æ ¼ç§»åŠ¨ç«¯ */
            .cards-grid {
                grid-template-columns: 1fr;
                gap: var(--mobile-card-gap);
            }
            
            /* é¡¹ç›®å¡ç‰‡ç§»åŠ¨ç«¯ä¼˜åŒ– */
            .project-card {
                padding: 16px;
                border-radius: 12px;
            }
            
            .card-header {
                margin-bottom: 12px;
            }
            
            .card-icon {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
            
            .card-info h3 {
                font-size: 16px;
                margin-bottom: 4px;
            }
            
            .card-info p {
                font-size: 13px;
            }
            
            /* åŠŸèƒ½åˆ—è¡¨ç§»åŠ¨ç«¯ */
            .card-features {
                margin: 12px 0;
            }
            
            .feature-item {
                padding: 8px 0;
                font-size: 13px;
            }
            
            /* æŒ‰é’®ç§»åŠ¨ç«¯ä¼˜åŒ– */
            .card-actions {
                gap: 8px;
            }
            
            .btn {
                padding: 10px 16px;
                font-size: 13px;
                min-height: var(--touch-target-size);
                border-radius: 8px;
            }
            
            /* è¯­è¨€åˆ‡æ¢å™¨ç§»åŠ¨ç«¯ */
            .language-switcher {
                top: 16px;
                right: 16px;
                padding: 6px;
            }
            
            .language-btn {
                padding: 4px 8px;
                font-size: 12px;
                min-width: 60px;
                height: 28px;
            }
            
            .language-name {
                display: none; /* ç§»åŠ¨ç«¯åªæ˜¾ç¤ºå›½æ—— */
            }
            
            /* RAGèŠå¤©ç•Œé¢ç§»åŠ¨ç«¯ */
            .rag-chat {
                height: calc(var(--real-vh, 1vh) * 100 - var(--mobile-header-height)); /* ä½¿ç”¨åŠ¨æ€è§†çª—é«˜åº¦ */
            }
            
            .chat-messages {
                padding: var(--mobile-padding);
                /* ä¼˜åŒ–ç§»åŠ¨ç«¯æ»šåŠ¨ */
                -webkit-overflow-scrolling: touch;
                scroll-behavior: smooth;
            }
            
            .message {
                margin-bottom: 12px;
                /* é˜²æ­¢æ¶ˆæ¯è¿‡å®½ */
                max-width: 100%;
                word-wrap: break-word;
            }
            
            .message-avatar {
                width: 32px;
                height: 32px;
                font-size: 16px;
                /* ç¡®ä¿å¤´åƒä¸ä¼šç¼©å° */
                flex-shrink: 0;
            }
            
            .message-content {
                font-size: var(--mobile-font-size);
                line-height: var(--mobile-line-height);
                padding: 10px 12px;
                /* ä¼˜åŒ–ç§»åŠ¨ç«¯æ–‡æœ¬æ˜¾ç¤º */
                word-break: break-word;
                overflow-wrap: break-word;
            }
            
            .chat-input {
                padding: var(--mobile-padding);
                /* ç¡®ä¿è¾“å…¥æ¡†åœ¨è½¯é”®ç›˜å¼¹å‡ºæ—¶å¯è§ */
                position: sticky;
                bottom: 0;
                background: var(--bg-secondary);
            }
            
            .chat-input-field {
                font-size: 16px; /* é˜²æ­¢iOSç¼©æ”¾ */
                padding: 12px 16px;
                min-height: var(--touch-target-size);
                border-radius: 12px;
            }
            
            .send-btn {
                min-width: var(--touch-target-size);
                height: var(--touch-target-size);
                font-size: 14px;
                border-radius: 12px;
            }
            
            /* è®¾ç½®é¡µé¢ç§»åŠ¨ç«¯ */
            .settings-container {
                padding: var(--mobile-padding);
            }
            
            .settings-section {
                padding: var(--mobile-padding);
                margin-bottom: 12px;
            }
            
            .settings-section h3 {
                font-size: 16px;
                margin-bottom: 12px;
            }
            
            /* å¯¼èˆªé¡¹ç§»åŠ¨ç«¯ */
            .nav-item {
                padding: 12px 20px;
                margin: 4px 12px;
                min-width: 180px; /* ç§»åŠ¨ç«¯ç¨å°çš„æœ€å°å®½åº¦ */
                height: 44px; /* ç§»åŠ¨ç«¯å›ºå®šé«˜åº¦ */
            }
            
            .nav-item-icon {
                width: 20px;
                height: 20px;
                font-size: 16px;
            }
            
            .nav-item-text {
                font-size: 14px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                min-width: 0;
            }
            
            .status-indicator {
                width: 6px;
                height: 6px;
            }
        }

        /* ğŸ“± å°å±æ‰‹æœºé€‚é… (æœ€å¤§480px) */
        @media (max-width: 480px) {
            .sidebar {
                width: 280px !important; /* å¼ºåˆ¶å›ºå®šå®½åº¦ */
                min-width: 280px !important;
                max-width: 280px !important;
            }
            
            .header {
                padding-left: 60px;
            }
            
            .page-title {
                font-size: 16px;
                min-width: 80px; /* å°å±å¹•æ›´å°çš„æœ€å°å®½åº¦ */
            }
            
            .project-card {
                padding: 12px;
            }
            
            .card-info h3 {
                font-size: 15px;
            }
            
            .card-info p {
                font-size: 12px;
            }
            
            .feature-item {
                font-size: 12px;
            }
            
            .btn {
                padding: 8px 12px;
                font-size: 12px;
            }
            
            /* è¯­è¨€åˆ‡æ¢å™¨åœ¨headerä¸­ï¼Œä¸éœ€è¦å›ºå®šä½ç½® */
            
            .mobile-menu-btn {
                top: 12px;
                left: 12px;
                width: 40px;
                height: 40px;
            }
        }

        /* ğŸŒ æ¨ªå±é€‚é… */
        @media (max-width: 768px) and (orientation: landscape) {
            .header {
                height: 60px; /* ç»Ÿä¸€ä½¿ç”¨60pxé«˜åº¦ */
            }
            
            .rag-chat {
                height: calc(var(--real-vh, 1vh) * 100 - 60px); /* ä½¿ç”¨åŠ¨æ€è§†çª—é«˜åº¦ */
            }
            
            .sidebar {
                width: 280px !important; /* å¼ºåˆ¶å›ºå®šå®½åº¦ */
                min-width: 280px !important;
                max-width: 280px !important;
            }
            
            .mobile-menu-btn {
                width: 40px;
                height: 40px;
            }
        }

        /* ğŸ¯ è§¦æ‘¸ä¼˜åŒ– */
        @media (hover: none) and (pointer: coarse) {
            .nav-item:hover {
                background: var(--bg-secondary);
            }
            
            .nav-item:active {
                background: var(--bg-hover);
                transform: scale(0.98);
            }
            
            .btn:active {
                transform: scale(0.95);
            }
            
            .project-card:active {
                transform: scale(0.98);
            }

            /* å¢å¤§è§¦æ‘¸ç›®æ ‡ */
            .nav-item {
                min-height: var(--touch-target-size);
            }

            .btn {
                min-height: var(--touch-target-size);
                padding: 12px 20px;
            }

            /* ä¼˜åŒ–æ»šåŠ¨æ€§èƒ½ */
            .chat-messages {
                -webkit-overflow-scrolling: touch;
                scroll-behavior: smooth;
            }
        }

        /* ğŸ“± è¶…å°å±è®¾å¤‡é€‚é… (æœ€å¤§360px) */
        @media (max-width: 360px) {
            .sidebar {
                width: 280px !important; /* å¼ºåˆ¶å›ºå®šå®½åº¦ */
                min-width: 280px !important;
                max-width: 280px !important;
            }

            .header {
                padding-left: 60px;
            }

            .page-title {
                font-size: 16px;
            }

            .project-card {
                padding: 12px;
            }

            .card-header h3 {
                font-size: 16px;
            }

            .card-features {
                font-size: 12px;
            }

            .mobile-menu-btn {
                width: 36px;
                height: 36px;
                top: 12px;
                left: 12px;
            }

            .mobile-menu-btn span {
                width: 16px;
            }
        }

        /* ğŸ“± å¤§å±æ‰‹æœºé€‚é… (481px - 640px) */
        @media (min-width: 481px) and (max-width: 640px) {
            .cards-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }

            .project-card {
                padding: 18px;
            }
        }

        /* ğŸ–¥ï¸ å¤§å±å¹•ä¼˜åŒ– (1440px+) */
        @media (min-width: 1440px) {
            .cards-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 24px;
                max-width: 1400px;
                margin: 0 auto;
            }

            .content {
                max-width: 1400px;
                margin: 0 auto;
            }
        }

        /* ğŸ–¥ï¸ è¶…å¤§å±å¹•ä¼˜åŒ– (1920px+) */
        @media (min-width: 1920px) {
            .cards-grid {
                grid-template-columns: repeat(5, 1fr);
                max-width: 1800px;
            }

            .content {
                max-width: 1800px;
            }
        }

        /* ğŸ“± æŠ˜å å±è®¾å¤‡é€‚é… */
        @media (min-width: 600px) and (max-width: 900px) and (orientation: portrait) {
            .cards-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }

            .sidebar {
                width: 280px !important; /* å¼ºåˆ¶å›ºå®šå®½åº¦ */
                min-width: 280px !important;
                max-width: 280px !important;
            }
        }

        /* ğŸ“± å¹³æ¿æ¨ªå±ä¼˜åŒ– */
        @media (min-width: 768px) and (max-width: 1024px) and (orientation: landscape) {
            .cards-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 20px;
            }

            .project-card {
                padding: 20px;
            }
        }

        /* ğŸ”„ åŠ¨æ€å²›é€‚é… (iPhone 14 Proç³»åˆ—) */
        @media screen and (device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) {
            .header {
                padding-top: env(safe-area-inset-top, 0);
                height: calc(60px + env(safe-area-inset-top, 0));
            }

            .mobile-menu-btn {
                top: calc(16px + env(safe-area-inset-top, 0));
            }
        }

        /* ğŸ”„ åˆ˜æµ·å±é€‚é… */
        @supports (padding: max(0px)) {
            .header {
                padding-left: max(24px, env(safe-area-inset-left));
                padding-right: max(24px, env(safe-area-inset-right));
            }

            .sidebar {
                padding-left: env(safe-area-inset-left, 0);
            }

            .mobile-menu-btn {
                left: max(16px, env(safe-area-inset-left));
            }
        }

        /* ğŸ¯ é«˜åˆ·æ–°ç‡å±å¹•ä¼˜åŒ– */
        @media (min-resolution: 120dpi) {
            * {
                will-change: auto;
            }

            .nav-item,
            .project-card,
            .btn {
                backface-visibility: hidden;
                transform: translateZ(0);
            }
        }

        /* ğŸ“± å°å±å¹•å¯†åº¦ä¼˜åŒ– */
        @media (max-width: 480px) and (min-resolution: 2dppx) {
            .project-card {
                border-width: 0.5px;
            }

            .sidebar {
                border-right-width: 0.5px;
            }

            .header {
                border-bottom-width: 0.5px;
            }
        }
    </style>
</head>
<body>
    <!-- ğŸ“± ç§»åŠ¨ç«¯æ±‰å ¡èœå•æŒ‰é’® -->
    <button class="mobile-menu-btn" id="mobileMenuBtn">
        <span></span>
        <span></span>
        <span></span>
    </button>
    

    
    <!-- ğŸ“± ç§»åŠ¨ç«¯é®ç½©å±‚ -->
    <div class="mobile-overlay" id="mobileOverlay"></div>
    
    <div class="app-container">
        <!-- ä¾§è¾¹æ  -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">ğŸš€</div>
                    <div class="logo-text">NEXUS</div>
                </div>
                <div class="logo-subtitle">Command Center</div>
            </div>
            
            <nav class="sidebar-nav">
                <button class="nav-item active" onclick="showPage('dashboard')">
                    <div class="nav-item-icon">ğŸ“Š</div>
                    <div class="nav-item-text" data-i18n="nav.dashboard">ä»ªè¡¨æ¿</div>
                    <div class="status-indicator online"></div>
                </button>
                
                <button class="nav-item" onclick="showPage('rag-system')">
                    <div class="nav-item-icon">ğŸ§ </div>
                    <div class="nav-item-text" data-i18n="nav.ragSystem">RAGç³»ç»Ÿ</div>
                    <div class="status-indicator online"></div>
                </button>
                
                <button class="nav-item" onclick="showPage('changlee')">
                    <div class="nav-item-icon">ğŸ±</div>
                    <div class="nav-item-text" data-i18n="nav.changlee">é•¿åˆ©</div>
                    <div class="status-indicator online"></div>
                </button>
                
                <button class="nav-item" onclick="showPage('nexus')">
                    <div class="nav-item-icon">âš¡</div>
                    <div class="nav-item-text" data-i18n="nav.nexus">NEXUS</div>
                    <div class="status-indicator online"></div>
                </button>
                
                <button class="nav-item" onclick="showPage('bovine')">
                    <div class="nav-item-icon">ğŸ„</div>
                    <div class="nav-item-text" data-i18n="nav.bovineInsight">ç‰›è®¤è¯†ç³»ç»Ÿ</div>
                    <div class="status-indicator offline"></div>
                </button>
                
                <button class="nav-item" onclick="showPage('chronicle')">
                    <div class="nav-item-icon">ğŸ“</div>
                    <div class="nav-item-text" data-i18n="nav.chronicle">ç¼–å¹´å²</div>
                    <div class="status-indicator offline"></div>
                </button>
                
                <button class="nav-item" onclick="showPage('genome')">
                    <div class="nav-item-icon">ğŸ§¬</div>
                    <div class="nav-item-text" data-i18n="nav.genomeJigsaw">åŸºå› æ‹¼å›¾</div>
                    <div class="status-indicator online"></div>
                </button>
                
                <button class="nav-item" onclick="showPage('molecular')">
                    <div class="nav-item-icon">ğŸ§ª</div>
                    <div class="nav-item-text" data-i18n="nav.molecularSimulation">åˆ†å­æ¨¡æ‹Ÿ</div>
                    <div class="status-indicator online"></div>
                </button>
            </nav>
            
            <div class="sidebar-footer">
                <button class="nav-item" onclick="showPage('settings')">
                    <div class="nav-item-icon">âš™ï¸</div>
                    <div class="nav-item-text" data-i18n="nav.settings">è®¾ç½®</div>
                </button>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒº -->
        <div class="main-content">
            <!-- å¤´éƒ¨ -->
            <header class="header">
                <div class="header-left">
                    <button class="back-btn" onclick="handleBackButton()">â†</button>
                    <h1 class="page-title" data-i18n="titles.dashboard">ä»ªè¡¨æ¿</h1>
                </div>
                <div class="header-right">
                    <!-- ğŸŒ è¯­è¨€åˆ‡æ¢å™¨ -->
                    <div class="language-switcher" id="languageSwitcher">
                        <button class="language-btn" id="languageBtn">
                            <span class="language-flag">ğŸ‡¨ğŸ‡³</span>
                            <span class="language-name">ä¸­æ–‡</span>
                        </button>
                        <div class="language-dropdown" id="languageDropdown">
                            <div class="language-option active" data-lang="zh-CN">
                                <span>ğŸ‡¨ğŸ‡³</span>
                                <span>ç®€ä½“ä¸­æ–‡</span>
                            </div>
                            <div class="language-option" data-lang="en-US">
                                <span>ğŸ‡ºğŸ‡¸</span>
                                <span>English</span>
                            </div>
                            <div class="language-option" data-lang="ja-JP">
                                <span>ğŸ‡¯ğŸ‡µ</span>
                                <span>æ—¥æœ¬èª</span>
                            </div>
                        </div>
                    </div>
                    <button class="theme-toggle-btn" onclick="toggleTheme()" id="themeToggle">ğŸŒ™</button>
                    <button class="header-btn" onclick="showPage('settings')">âš™ï¸</button>

                    <button class="header-btn">ğŸ””</button>
                    <button class="header-btn">ğŸ‘¤</button>
                </div>
            </header>

            <!-- Dashboard å†…å®¹ -->
            <div id="dashboard-content" class="content">
                <div class="cards-grid">
                    <!-- NEXUS Remote Control å¡ç‰‡ -->
                    <div class="project-card">
                        <div class="card-header">
                            <div class="card-icon nexus">âš¡</div>
                            <div class="card-info">
                                <h3>NEXUS Remote Control</h3>
                                <p>Revolutionary Remote Command & Control System</p>
                            </div>
                        </div>
                        <div class="card-description">
                            çªç ´å±€åŸŸç½‘é™åˆ¶ï¼Œå®ç°çœŸæ­£çš„å…¨çƒè¿œç¨‹ç”µæºç®¡ç†ã€‚æ”¯æŒè¿œç¨‹å¼€æœºã€å…³æœºã€é‡å¯ï¼Œä¼ä¸šçº§å®‰å…¨ä¿éšœã€‚
                        </div>
                        <div class="card-features">
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>å…¨çƒè¿œç¨‹è®¿é—® - äº‘æœåŠ¡å™¨ä¸­è½¬</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>å®Œæ•´ç”µæºç®¡ç† - WOL/å…³æœº/é‡å¯</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>é›¶å‘½ä»¤è¡Œä½“éªŒ - å›¾å½¢åŒ–ç•Œé¢</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>ç§»åŠ¨ç«¯ä¼˜åŒ– - PWAåŸç”Ÿä½“éªŒ</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>ä¼ä¸šçº§å®‰å…¨ - 256ä½åŠ å¯†</span>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-primary">
                                ğŸš€ å¯åŠ¨ NEXUS
                            </button>
                            <button class="btn btn-secondary">
                                ğŸ“ æ–‡æ¡£
                            </button>
                        </div>
                    </div>

                    <!-- RAG System å¡ç‰‡ -->
                    <div class="project-card">
                        <div class="card-header">
                            <div class="card-icon rag">ğŸ§ </div>
                            <div class="card-info">
                                <h3>RAG System</h3>
                                <p>Retrieval-Augmented Generation AI</p>
                            </div>
                        </div>

                        <div class="card-features">
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>å¤šæ ¼å¼æ–‡æ¡£ - PDF/DOCX/Excel/Markdown</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>æ™ºèƒ½æ£€ç´¢ - å‘é‡è¯­ä¹‰æœç´¢</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>è®°å¿†ç³»ç»Ÿ - æ°¸ä¹…/ä¸´æ—¶è®°å¿†ç®¡ç†</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>å¤šè½®å¯¹è¯ - ä¸Šä¸‹æ–‡ç†è§£</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>APIç®¡ç† - å¤šæ¨¡å‹æ”¯æŒ</span>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-primary" onclick="showRAGChat()">
                                ğŸ§  å¯åŠ¨ RAG
                            </button>
                            <button class="btn btn-secondary">
                                ğŸ“š æ–‡æ¡£åº“
                            </button>
                        </div>
                    </div>

                    <!-- Unified Platform å¡ç‰‡ -->
                    <div class="project-card">
                        <div class="card-header">
                            <div class="card-icon platform">ğŸ“Š</div>
                            <div class="card-info">
                                <h3>Unified Platform</h3>
                                <p>Research Workstation Management</p>
                            </div>
                        </div>
                        <div class="card-description">
                            æ•´ä¸ªç ”ç©¶å·¥ä½œç«™çš„ç»Ÿä¸€å®‰è£…å™¨ã€å¯åŠ¨å™¨å’Œç®¡ç†å™¨ï¼Œæä¾›ä¸€ç«™å¼çš„ç³»ç»Ÿç®¡ç†ä½“éªŒã€‚
                        </div>
                        <div class="card-features">
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>ç³»ç»Ÿçº§éƒ¨ç½² - èˆ°é˜Ÿæ€»æŒ‡æŒ¥èƒ½åŠ›</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>ä¾èµ–æ£€æŸ¥ - è‡ªåŠ¨ç¯å¢ƒé…ç½®</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-check">âœ“</span>
                                <span>çŠ¶æ€ç›‘æ§ - å®æ—¶ç³»ç»ŸçŠ¶æ€</span>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-primary">
                                ğŸš€ ç®¡ç†å¹³å°
                            </button>
                            <button class="btn btn-secondary" onclick="showPage('project-info')">
                                ğŸ“– é¡¹ç›®è¯´æ˜
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RAG èŠå¤©ç•Œé¢ -->
            <div id="rag-chat" class="rag-chat">
                
                <div class="chat-messages" id="chatMessages">
                    <div class="message">
                        <div class="message-avatar">ğŸ§ </div>
                        <div class="message-content">
                            ä½ å¥½ï¼æˆ‘æ˜¯RAGæ™ºèƒ½åŠ©æ‰‹ï¼Œå¯ä»¥å¸®ä½ åˆ†ææ–‡æ¡£ã€å›ç­”é—®é¢˜ã€‚<br><br>
                            ğŸ“‹ æ”¯æŒæ ¼å¼ï¼šMarkdown (.md), æ–‡æœ¬ (.txt), ä»£ç æ–‡ä»¶ (.py, .js, .html, .css), é…ç½®æ–‡ä»¶ (.json, .xml, .yml) ç­‰<br><br>
                            è¯·ä¸Šä¼ æ–‡æ¡£æˆ–ç›´æ¥æé—®ï¼
                        </div>
                    </div>
                </div>
                
                <div class="chat-input">
                    <div class="input-group">
                        <button class="function-btn" onclick="toggleFunctionMenu()" id="functionBtn">
                            <span class="function-icon">âš¡</span>
                        </button>
                        <input type="text" class="chat-input-field" placeholder="è¾“å…¥ä½ çš„é—®é¢˜..." id="chatInput">
                        <button class="send-btn" onclick="sendMessage()">å‘é€</button>
                    </div>
                    
                    <!-- åŠŸèƒ½èœå• -->
                    <div class="function-menu" id="functionMenu">
                        <div class="function-item" onclick="uploadFile()">
                            <span class="function-item-icon">ğŸ“</span>
                            <span class="function-item-text">ä¸Šä¼ æ–‡ä»¶</span>
                        </div>
                        <div class="function-item" onclick="recordAudio()">
                            <span class="function-item-icon">ğŸ¤</span>
                            <span class="function-item-text">è¯­éŸ³è¾“å…¥</span>
                        </div>
                        <div class="function-item" onclick="showStorageStatus()">
                            <span class="function-item-icon">ğŸ’¾</span>
                            <span class="function-item-text">å­˜å‚¨çŠ¶æ€</span>
                        </div>
                        <div class="function-item" onclick="reconnectRAG()">
                            <span class="function-item-icon">ğŸ”„</span>
                            <span class="function-item-text">é‡æ–°è¿æ¥</span>
                        </div>
                        <div class="function-item" onclick="clearChat()">
                            <span class="function-item-icon">ğŸ—‘ï¸</span>
                            <span class="function-item-text">æ¸…ç©ºå¯¹è¯</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- è®¾ç½®é¡µé¢ -->
            <div id="settings-page" class="settings-page">
                <div class="settings-container">
                    <div class="settings-section">
                        <h3 data-i18n="settings.appearance">ğŸ¨ å¤–è§‚è®¾ç½®</h3>
                        <div class="setting-item">
                            <label data-i18n="settings.theme">ä¸»é¢˜æ¨¡å¼</label>
                            <select id="themeSelect" onchange="changeThemeMode(this.value)">
                                <option value="dark" data-i18n="settings.darkTheme">æ·±è‰²ä¸»é¢˜</option>
                                <option value="light" data-i18n="settings.lightTheme">æµ…è‰²ä¸»é¢˜</option>
                                <option value="auto" data-i18n="settings.autoTheme">è·Ÿéšç³»ç»Ÿ</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label data-i18n="settings.animations">åŠ¨ç”»æ•ˆæœ</label>
                            <input type="checkbox" checked>
                        </div>
                        <div class="setting-item">
                            <label data-i18n="settings.compactMode">ç´§å‡‘æ¨¡å¼</label>
                            <input type="checkbox">
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 data-i18n="settings.system">ğŸ”§ ç³»ç»Ÿè®¾ç½®</h3>
                        <div class="setting-item">
                            <label data-i18n="settings.autoSave">è‡ªåŠ¨ä¿å­˜</label>
                            <input type="checkbox" checked>
                        </div>
                        <div class="setting-item">
                            <label data-i18n="settings.notifications">é€šçŸ¥æé†’</label>
                            <input type="checkbox" checked>
                        </div>
                        <div class="setting-item">
                            <label data-i18n="settings.language">è¯­è¨€</label>
                            <select id="languageSelect" onchange="changeLanguageFromSettings(this.value)">
                                <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                                <option value="en-US">English</option>
                                <option value="ja-JP">æ—¥æœ¬èª</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label data-i18n="settings.sidebarEnglish">ä¾§è¾¹æ å›ºå®šè‹±æ–‡</label>
                            <input type="checkbox" id="sidebarEnglishToggle" onchange="toggleSidebarEnglish(this.checked)">
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 data-i18n="settings.performance">âš¡ æ€§èƒ½è®¾ç½®</h3>
                        <div class="setting-item">
                            <label data-i18n="settings.hardwareAcceleration">ç¡¬ä»¶åŠ é€Ÿ</label>
                            <input type="checkbox" checked>
                        </div>
                        <div class="setting-item">
                            <label data-i18n="settings.preloadContent">é¢„åŠ è½½å†…å®¹</label>
                            <input type="checkbox">
                        </div>
                        <div class="setting-item">
                            <label data-i18n="settings.cacheSize">ç¼“å­˜å¤§å°</label>
                            <select>
                                <option value="small" data-i18n="settings.cacheSmall">å° (100MB)</option>
                                <option value="medium" selected data-i18n="settings.cacheMedium">ä¸­ (500MB)</option>
                                <option value="large" data-i18n="settings.cacheLarge">å¤§ (1GB)</option>
                            </select>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 data-i18n="settings.about">ğŸ“Š å…³äº</h3>
                        <div class="setting-item">
                            <label data-i18n="settings.version">ç‰ˆæœ¬</label>
                            <span class="version-info">NEXUS v2.0.0</span>
                        </div>
                        <div class="setting-item">
                            <label data-i18n="settings.updateCheck">æ›´æ–°æ£€æŸ¥</label>
                            <button class="btn btn-secondary" data-i18n="settings.checkUpdate">æ£€æŸ¥æ›´æ–°</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ç©ºç™½é¡µé¢ -->
            <div id="empty-page" class="empty-page">
                <div class="empty-content">
                    <div class="empty-icon">ğŸš§</div>
                    <h3>åŠŸèƒ½å¼€å‘ä¸­</h3>
                    <p>è¯¥åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…...</p>
                </div>
            </div>

            <div id="project-info-page" class="content" style="display: none;">
                <div class="project-info-container">
                    <!-- é¡¹ç›®ä»‹ç»é¦–é¡µ - å…¨å±æ˜¾ç¤º -->
                    <div class="project-hero">
                        <div class="project-hero-title">
                            <span class="rocket">ğŸš€</span>
                            <span class="nss-title">N.S.S</span>
                            <span class="novena-title">Novena Garfield</span>
                        </div>
                        <h2>ç§‘ç ”å·¥ä½œç®¡ç†å¹³å°</h2>
                        <p>çªç ´ä¼ ç»Ÿé™åˆ¶ï¼Œå®ç°çœŸæ­£çš„å…¨çƒè¿œç¨‹ç®¡ç†ã€‚é›†æˆåŒ–ç ”ç©¶å·¥ä½œç«™å¹³å°ï¼Œæä¾›å…¨æ–¹ä½çš„ç§‘ç ”è®¡ç®—ã€æ•°æ®åˆ†æå’Œç³»ç»Ÿç®¡ç†è§£å†³æ–¹æ¡ˆã€‚</p>
                        <div class="scroll-indicator">
                            â†“ å‘ä¸‹æ»šåŠ¨äº†è§£æ›´å¤š
                        </div>
                    </div>
                    
                    <!-- è¯¦ç»†å†…å®¹éƒ¨åˆ† -->
                    <div class="project-content">
                        <section class="project-section">
                            <h2>ğŸ¯ é¡¹ç›®æ¦‚è¿°</h2>
                            <p>N.S.S (Novena Scientific Suite) æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„ç§‘å­¦ç ”ç©¶å·¥ä½œç«™ï¼Œé›†æˆäº†å¤šä¸ªå…ˆè¿›çš„ç ”ç©¶å·¥å…·å’Œç³»ç»Ÿï¼Œä¸ºç§‘ç ”å·¥ä½œè€…æä¾›ä¸€ç«™å¼çš„ç ”ç©¶ç¯å¢ƒã€‚</p>
                        </section>

                        <section class="project-section">
                            <h2>ğŸ”§ æ ¸å¿ƒç»„ä»¶</h2>
                            <div class="components-grid">
                                <div class="component-card">
                                    <h3>âš¡ NEXUS Remote Control</h3>
                                    <p>é©å‘½æ€§çš„è¿œç¨‹å‘½ä»¤æ§åˆ¶ç³»ç»Ÿï¼Œçªç ´å±€åŸŸç½‘é™åˆ¶ï¼Œå®ç°å…¨çƒè¿œç¨‹ç”µæºç®¡ç†ã€‚</p>
                                </div>
                                <div class="component-card">
                                    <h3>ğŸ§  RAG System</h3>
                                    <p>æ£€ç´¢å¢å¼ºç”ŸæˆAIç³»ç»Ÿï¼Œæ”¯æŒå¤šæ–‡æ¡£æ ¼å¼ï¼Œæä¾›æ™ºèƒ½å¯¹è¯å’ŒçŸ¥è¯†æ£€ç´¢åŠŸèƒ½ã€‚</p>
                                </div>
                                <div class="component-card">
                                    <h3>ğŸŒ¸ é•¿ç¦» (Changlee)</h3>
                                    <p>ä¸“ä¸šçš„ç§‘ç ”æ•°æ®åˆ†æå¹³å°ï¼Œæä¾›é«˜æ•ˆçš„æ•°æ®å¤„ç†å’Œå¯è§†åŒ–åŠŸèƒ½ã€‚</p>
                                </div>
                                <div class="component-card">
                                    <h3>ğŸ„ ç‰›è¯†åˆ«ç³»ç»Ÿ (Bovine Insight)</h3>
                                    <p>åŸºäºAIçš„ç‰›åªè¯†åˆ«å’Œç®¡ç†ç³»ç»Ÿï¼Œä¸ºç•œç‰§ä¸šæä¾›æ™ºèƒ½åŒ–è§£å†³æ–¹æ¡ˆã€‚</p>
                                </div>
                                <div class="component-card">
                                    <h3>ğŸ“Š å®éªŒè®°å½•ä»ª (Chronicle)</h3>
                                    <p>ä¸“ä¸šçš„å®éªŒæ•°æ®è®°å½•å’Œç®¡ç†ç³»ç»Ÿï¼Œç¡®ä¿ç ”ç©¶è¿‡ç¨‹çš„å®Œæ•´æ€§å’Œå¯è¿½æº¯æ€§ã€‚</p>
                                </div>
                                <div class="component-card">
                                    <h3>ğŸ§¬ åŸºå› æ‹¼å›¾ (Genome Jigsaw)</h3>
                                    <p>åŸºå› ç»„å­¦åˆ†æå·¥å…·ï¼Œæä¾›åºåˆ—åˆ†æã€æ¯”å¯¹å’Œå¯è§†åŒ–åŠŸèƒ½ã€‚</p>
                                </div>
                                <div class="component-card">
                                    <h3>âš›ï¸ åˆ†å­æ¨¡æ‹Ÿ (Molecular Simulation)</h3>
                                    <p>é«˜æ€§èƒ½åˆ†å­åŠ¨åŠ›å­¦æ¨¡æ‹Ÿå¹³å°ï¼Œæ”¯æŒå¤æ‚åˆ†å­ç³»ç»Ÿçš„å»ºæ¨¡å’Œåˆ†æã€‚</p>
                                </div>
                            </div>
                        </section>

                        <section class="project-section">
                            <h2>âœ¨ ä¸»è¦ç‰¹æ€§</h2>
                            <ul class="features-list">
                                <li>ğŸŒ å¤šè¯­è¨€æ”¯æŒ (ä¸­æ–‡/è‹±æ–‡/æ—¥è¯­)</li>
                                <li>ğŸ¨ ç°ä»£åŒ–å“åº”å¼ç•Œé¢è®¾è®¡</li>
                                <li>ğŸ”’ ä¼ä¸šçº§å®‰å…¨ä¿éšœ</li>
                                <li>ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–ä½“éªŒ</li>
                                <li>ğŸš€ é«˜æ€§èƒ½è®¡ç®—æ”¯æŒ</li>
                                <li>ğŸ”§ æ¨¡å—åŒ–æ¶æ„è®¾è®¡</li>
                                <li>ğŸ“Š å®æ—¶æ•°æ®ç›‘æ§</li>
                                <li>ğŸ¤– AIé©±åŠ¨çš„æ™ºèƒ½åˆ†æ</li>
                            </ul>
                        </section>

                    </div>
                    
                    <!-- æŠ€æœ¯æ ˆå…¨å±é¡µé¢ -->
                    <div class="tech-stack-hero">
                        <h2>ğŸ”§ æŠ€æœ¯æ ˆ</h2>
                        <p class="description">é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–çš„æŠ€æœ¯æ ˆï¼Œç¡®ä¿é«˜æ€§èƒ½ã€é«˜å¯ç”¨æ€§å’Œè‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ</p>
                        <div class="tech-grid">
                            <div class="tech-item">HTML5 / CSS3</div>
                            <div class="tech-item">JavaScript ES6+</div>
                            <div class="tech-item">Python 3.x</div>
                            <div class="tech-item">WebSocket</div>
                            <div class="tech-item">RESTful API</div>
                            <div class="tech-item">Docker</div>
                            <div class="tech-item">GROMACS</div>
                            <div class="tech-item">OpenAI API</div>
                            <div class="tech-item">Wake-on-LAN</div>
                            <div class="tech-item">Cloudflare</div>
                            <div class="tech-item">GitHub Actions</div>
                            <div class="tech-item">PWA</div>
                        </div>
                    </div>

                    <!-- ä¸‹è½½é¡µé¢ -->
                    <div class="download-hero">
                        <div class="download-container">
                            <div class="download-header">
                                <div class="download-icon">ğŸ¯</div>
                                <h2>ç«‹å³ä½“éªŒ N.S.S</h2>
                            </div>
                            <p class="download-description">é€‰æ‹©é€‚åˆæ‚¨æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬ï¼Œå¼€å§‹äº«å—çœŸæ­£çš„è¿œç¨‹æ§åˆ¶ä½“éªŒ</p>
                            
                            <div class="download-buttons">
                                <a href="#" class="download-btn linux">
                                    <div class="btn-icon">ğŸ§</div>
                                    <div class="btn-content">
                                        <div class="btn-title">ä¸‹è½½ Linux ç‰ˆæœ¬</div>
                                        <div class="btn-subtitle">.AppImage</div>
                                    </div>
                                    <div class="btn-badge">æ¨è</div>
                                </a>
                                
                                <a href="#" class="download-btn windows">
                                    <div class="btn-icon">ğŸªŸ</div>
                                    <div class="btn-content">
                                        <div class="btn-title">Windows (.exe)</div>
                                        <div class="btn-subtitle">Windows 10/11</div>
                                    </div>
                                </a>
                                
                                <a href="#" class="download-btn macos">
                                    <div class="btn-icon">ğŸ</div>
                                    <div class="btn-content">
                                        <div class="btn-title">macOS (.dmg)</div>
                                        <div class="btn-subtitle">Intel & Apple Silicon</div>
                                    </div>
                                </a>
                            </div>

                            <div class="download-links">
                                <a href="#" class="link-item">
                                    <span class="link-icon">ğŸ“</span>
                                    <span>GitHub Repository</span>
                                </a>
                                <a href="#" class="link-item">
                                    <span class="link-icon">ğŸš€</span>
                                    <span>éƒ¨ç½²æŒ‡å—</span>
                                </a>
                                <a href="#" class="link-item">
                                    <span class="link-icon">ğŸ›</span>
                                    <span>é—®é¢˜åé¦ˆ</span>
                                </a>
                                <a href="#" class="link-item">
                                    <span class="link-icon">ğŸ“§</span>
                                    <span>Email Support</span>
                                </a>
                            </div>

                            <div class="download-footer">
                                <p>ğŸ‰ N.S.S Novena Garfield - è®©è¿œç¨‹æ§åˆ¶å˜å¾—ç®€å•è€Œå¼ºå¤§</p>
                                <p class="copyright">Â© 2025 Research Workstation Team. é‡‡ç”¨ MIT å¼€æºåè®®</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸŒ å¼•å…¥è¯­è¨€åŒ…å’Œå›½é™…åŒ–ç®¡ç†å™¨ -->
    <script src="i18n/languages.js"></script>
    <script src="i18n/i18n-manager.js"></script>
    
    <script>
        let currentPage = 'dashboard';
        let currentTheme = 'dark';
        let i18n = null; // å›½é™…åŒ–ç®¡ç†å™¨å®ä¾‹
        
        // èŠå¤©è®°å½•å­˜å‚¨ç³»ç»Ÿ
        const CHAT_STORAGE_KEY = 'nexus_rag_chat_history';
        const MAX_STORED_MESSAGES = 100; // æœ€å¤šå­˜å‚¨100æ¡æ¶ˆæ¯
        let currentTaskName = 'nexus_chat';
        
        // èŠå¤©è®°å½•ç®¡ç†å‡½æ•°
        function saveChatHistory() {
            try {
                const messages = [];
                const messageElements = document.querySelectorAll('#chatMessages .message');
                
                messageElements.forEach(element => {
                    const avatar = element.querySelector('.message-avatar')?.textContent || 'ğŸ‘¤';
                    const content = element.querySelector('.message-content')?.innerHTML || '';
                    const role = avatar === 'ğŸ§ ' ? 'assistant' : 'user';
                    
                    if (content.trim()) {
                        messages.push({
                            role: role,
                            content: content,
                            avatar: avatar,
                            timestamp: Date.now()
                        });
                    }
                });
                
                // åªä¿ç•™æœ€æ–°çš„æ¶ˆæ¯
                const recentMessages = messages.slice(-MAX_STORED_MESSAGES);
                localStorage.setItem(CHAT_STORAGE_KEY, JSON.stringify(recentMessages));
                
                console.log(`ğŸ’¾ å·²ä¿å­˜ ${recentMessages.length} æ¡èŠå¤©è®°å½•`);
            } catch (error) {
                console.error('ä¿å­˜èŠå¤©è®°å½•å¤±è´¥:', error);
            }
        }
        
        function loadChatHistory() {
            try {
                const stored = localStorage.getItem(CHAT_STORAGE_KEY);
                if (!stored) return false;
                
                const messages = JSON.parse(stored);
                if (!Array.isArray(messages) || messages.length === 0) return false;
                
                const chatMessages = document.getElementById('chatMessages');
                if (!chatMessages) return false;
                
                // æ¸…ç©ºç°æœ‰æ¶ˆæ¯ï¼ˆé™¤äº†æ¬¢è¿æ¶ˆæ¯ï¼‰
                const welcomeMessage = chatMessages.querySelector('.message');
                chatMessages.innerHTML = '';
                
                // æ¢å¤æ¬¢è¿æ¶ˆæ¯
                if (welcomeMessage) {
                    chatMessages.appendChild(welcomeMessage);
                }
                
                // æ¢å¤å†å²æ¶ˆæ¯
                messages.forEach(msg => {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'message';
                    messageDiv.innerHTML = `
                        <div class="message-avatar">${msg.avatar}</div>
                        <div class="message-content">${msg.content}</div>
                    `;
                    chatMessages.appendChild(messageDiv);
                });
                
                // æ»šåŠ¨åˆ°åº•éƒ¨
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                console.log(`ğŸ“š å·²æ¢å¤ ${messages.length} æ¡èŠå¤©è®°å½•`);
                return true;
            } catch (error) {
                console.error('åŠ è½½èŠå¤©è®°å½•å¤±è´¥:', error);
                return false;
            }
        }
        
        function clearChatHistory() {
            try {
                localStorage.removeItem(CHAT_STORAGE_KEY);
                console.log('ğŸ—‘ï¸ å·²æ¸…ç©ºæœ¬åœ°èŠå¤©è®°å½•');
            } catch (error) {
                console.error('æ¸…ç©ºèŠå¤©è®°å½•å¤±è´¥:', error);
            }
        }
        
        function showStorageStatus() {
            try {
                const stored = localStorage.getItem(CHAT_STORAGE_KEY);
                let messageCount = 0;
                let storageSize = 0;
                let lastUpdate = 'æ— ';
                
                if (stored) {
                    const messages = JSON.parse(stored);
                    messageCount = messages.length;
                    storageSize = new Blob([stored]).size;
                    
                    // æ‰¾åˆ°æœ€æ–°æ¶ˆæ¯çš„æ—¶é—´æˆ³
                    if (messages.length > 0) {
                        const latestTimestamp = Math.max(...messages.map(m => m.timestamp || 0));
                        if (latestTimestamp > 0) {
                            lastUpdate = new Date(latestTimestamp).toLocaleString('zh-CN');
                        }
                    }
                }
                
                const statusMessage = `
                    ğŸ“Š <strong>èŠå¤©è®°å½•å­˜å‚¨çŠ¶æ€</strong><br><br>
                    ğŸ’¬ <strong>æ¶ˆæ¯æ•°é‡:</strong> ${messageCount} æ¡<br>
                    ğŸ“¦ <strong>å­˜å‚¨å¤§å°:</strong> ${(storageSize / 1024).toFixed(2)} KB<br>
                    ğŸ•’ <strong>æœ€åæ›´æ–°:</strong> ${lastUpdate}<br>
                    ğŸ’¾ <strong>å­˜å‚¨ä½ç½®:</strong> æµè§ˆå™¨æœ¬åœ°å­˜å‚¨<br>
                    ğŸ”„ <strong>è‡ªåŠ¨ä¿å­˜:</strong> å·²å¯ç”¨<br><br>
                    <small>ğŸ’¡ æç¤º: èŠå¤©è®°å½•ä¼šè‡ªåŠ¨ä¿å­˜åˆ°æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼Œåˆ·æ–°é¡µé¢åä¼šè‡ªåŠ¨æ¢å¤ã€‚æœ€å¤šä¿å­˜ ${MAX_STORED_MESSAGES} æ¡æ¶ˆæ¯ã€‚</small>
                `;
                
                addMessage(statusMessage, 'assistant');
                
            } catch (error) {
                console.error('è·å–å­˜å‚¨çŠ¶æ€å¤±è´¥:', error);
                addMessage('âŒ è·å–å­˜å‚¨çŠ¶æ€å¤±è´¥', 'assistant');
            }
            
            toggleFunctionMenu();
        }
        
        // å…¨å±€å˜é‡ï¼Œä¾›i18n-manager.jsè®¿é—®
        window.sidebarEnglishMode = false;

        // é¡µé¢æ ‡é¢˜æ˜ å°„
        const pageTitles = {
            'dashboard': 'ä»ªè¡¨æ¿',
            'project-info': 'N.S.S - Novena Garfield',
            'rag-system': 'RAG System',
            'changlee': 'Changlee',
            'nexus': 'NEXUS',
            'bovine': 'Bovine Insight',
            'chronicle': 'Chronicle',
            'genome': 'Genome Jigsaw',
            'molecular': 'Molecular Simulation',
            'settings': 'Settings'
        };

        function showPage(pageId) {
            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            // éšè—è¿æ¥çŠ¶æ€æ¡†ï¼ˆåªåœ¨RAGé¡µé¢æ˜¾ç¤ºï¼‰
            if (pageId !== 'rag-system') {
                hideConnectionStatus();
            }
            
            // éšè—æ‰€æœ‰å†…å®¹
            document.getElementById('dashboard-content').style.display = 'none';
            document.getElementById('rag-chat').style.display = 'none';
            document.getElementById('settings-page').style.display = 'none';
            document.getElementById('empty-page').style.display = 'none';
            document.getElementById('project-info-page').style.display = 'none';
            
            // æ˜¾ç¤ºå¯¹åº”å†…å®¹å’Œæ›´æ–°æ ‡é¢˜
            if (pageId === 'dashboard') {
                document.getElementById('dashboard-content').style.display = 'block';
            } else if (pageId === 'rag-system') {
                showRAGChat();
                return; // RAGæœ‰è‡ªå·±çš„å¯¼èˆªæ›´æ–°é€»è¾‘
            } else if (pageId === 'settings') {
                document.getElementById('settings-page').style.display = 'block';
                currentPage = 'settings'; // æ›´æ–°å½“å‰é¡µé¢çŠ¶æ€
                
                // æ›´æ–°è®¾ç½®é¡µé¢çš„å¯¼èˆªçŠ¶æ€
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelector('[onclick="showPage(\'settings\')"]').classList.add('active');
                
                // åŒæ­¥è®¾ç½®é¡µé¢çš„è¯­è¨€é€‰æ‹©å™¨å’Œæ›´æ–°é¡µé¢æ ‡é¢˜
                updateLanguageSwitcher();
                updatePageTitle();
            } else if (pageId === 'project-info') {
                document.getElementById('project-info-page').style.display = 'block';
                currentPage = 'project-info';
                
                // æ›´æ–°å¯¼èˆªçŠ¶æ€
                document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
                
                // æ›´æ–°é¡µé¢æ ‡é¢˜
                updatePageTitle();
            } else {
                // å…¶ä»–é¡µé¢æ˜¾ç¤ºç©ºç™½é¡µé¢
                document.getElementById('empty-page').style.display = 'flex';
            }
            
            // æ›´æ–°é¡µé¢æ ‡é¢˜
            const titleElement = document.querySelector('.page-title');
            if (titleElement) {
                const titleKey = `titles.${pageId.replace('-', '')}`;
                titleElement.setAttribute('data-i18n', titleKey);
                if (i18n) {
                    titleElement.textContent = i18n.t(titleKey, pageTitles[pageId] || 'Dashboard');
                }
            }
            currentPage = pageId;
        }

        function showRAGChat() {
            document.getElementById('dashboard-content').style.display = 'none';
            document.getElementById('rag-chat').style.display = 'flex';
            document.getElementById('settings-page').style.display = 'none';
            document.getElementById('empty-page').style.display = 'none';
            // æ›´æ–°é¡µé¢æ ‡é¢˜
            const titleElement = document.querySelector('.page-title');
            if (titleElement) {
                titleElement.setAttribute('data-i18n', 'titles.ragsystem');
                if (i18n) {
                    titleElement.textContent = i18n.t('titles.ragsystem', 'RAG System');
                }
            }
            
            // æ›´æ–°å½“å‰é¡µé¢çŠ¶æ€
            currentPage = 'rag-system';
            
            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector('[onclick="showPage(\'rag-system\')"]').classList.add('active');
        }

        // ç®€åŒ–çš„ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½ - åªåœ¨æ·±è‰²å’Œæµ…è‰²é—´åˆ‡æ¢
        function toggleTheme() {
            const themeToggle = document.getElementById('themeToggle');
            
            if (currentTheme === 'dark') {
                currentTheme = 'light';
                document.documentElement.setAttribute('data-theme', 'light');
                themeToggle.textContent = 'â˜€ï¸';
            } else {
                currentTheme = 'dark';
                document.documentElement.removeAttribute('data-theme');
                themeToggle.textContent = 'ğŸŒ™';
            }
            
            // ä¿å­˜ä¸»é¢˜è®¾ç½®
            localStorage.setItem('theme', currentTheme);
            
            // åŒæ­¥è®¾ç½®é¡µé¢çš„ä¸‹æ‹‰èœå•
            const themeSelect = document.getElementById('themeSelect');
            if (themeSelect) {
                themeSelect.value = currentTheme;
            }
        }

        // è®¾ç½®é¡µé¢çš„ä¸»é¢˜åˆ‡æ¢
        function changeThemeMode(theme) {
            currentTheme = theme;
            const themeToggle = document.getElementById('themeToggle');
            
            if (theme === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
                themeToggle.textContent = 'â˜€ï¸';
            } else if (theme === 'dark') {
                document.documentElement.removeAttribute('data-theme');
                themeToggle.textContent = 'ğŸŒ™';
            } else if (theme === 'auto') {
                // è·Ÿéšç³»ç»Ÿä¸»é¢˜
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (prefersDark) {
                    document.documentElement.removeAttribute('data-theme');
                    themeToggle.textContent = 'ğŸŒ™';
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                    themeToggle.textContent = 'â˜€ï¸';
                }
            }
            
            // ä¿å­˜ä¸»é¢˜è®¾ç½®
            localStorage.setItem('theme', theme);
        }

        // åˆå§‹åŒ–ä¸»é¢˜
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            currentTheme = savedTheme;
            const themeToggle = document.getElementById('themeToggle');
            const themeSelect = document.getElementById('themeSelect');
            
            if (savedTheme === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
                themeToggle.textContent = 'â˜€ï¸';
                if (themeSelect) themeSelect.value = 'light';
            } else if (savedTheme === 'dark') {
                document.documentElement.removeAttribute('data-theme');
                themeToggle.textContent = 'ğŸŒ™';
                if (themeSelect) themeSelect.value = 'dark';
            } else if (savedTheme === 'auto') {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (prefersDark) {
                    document.documentElement.removeAttribute('data-theme');
                    themeToggle.textContent = 'ğŸŒ™';
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                    themeToggle.textContent = 'â˜€ï¸';
                }
                if (themeSelect) themeSelect.value = 'auto';
            }
        }

        // å¼ºåˆ¶å›ºå®šä¾§è¾¹æ å®½åº¦
        function forceSidebarWidth() {
            const sidebar = document.querySelector('.sidebar');
            if (sidebar) {
                sidebar.style.setProperty('width', '280px', 'important');
                sidebar.style.setProperty('min-width', '280px', 'important');
                sidebar.style.setProperty('max-width', '280px', 'important');
                sidebar.style.setProperty('flex-shrink', '0', 'important');
                sidebar.style.setProperty('overflow', 'hidden', 'important');
            }
            
            console.log('ğŸ”§ å¼ºåˆ¶å›ºå®šä¾§è¾¹æ å®½åº¦å®Œæˆ');
        }



        // ä¾§è¾¹æ è‹±æ–‡å›ºå®šåŠŸèƒ½

        function toggleSidebarEnglish(enabled) {
            window.sidebarEnglishMode = enabled;
            localStorage.setItem('sidebarEnglish', enabled);
            
            if (enabled) {
                // å›ºå®šä¾§è¾¹æ ä¸ºè‹±æ–‡
                window.updateSidebarToEnglish();
            } else {
                // æ¢å¤æ­£å¸¸å›½é™…åŒ–
                if (i18n) {
                    i18n.updateElements();
                }
            }
            
            // æ— è®ºå¦‚ä½•éƒ½å¼ºåˆ¶å›ºå®šä¾§è¾¹æ å®½åº¦
            setTimeout(forceSidebarWidth, 100);
        }

        window.updateSidebarToEnglish = function() {
            const navItems = {
                'dashboard': 'Dashboard',
                'rag-system': 'RAG System', 
                'changlee': 'Changlee',
                'nexus': 'NEXUS',
                'bovine': 'Bovine Insight',
                'chronicle': 'Chronicle',
                'genome': 'Genome Jigsaw',
                'molecular': 'Molecular Simulation',
                'settings': 'Settings'
            };

            document.querySelectorAll('.nav-item').forEach(item => {
                const pageId = item.getAttribute('onclick')?.match(/showPage\('([^']+)'\)/)?.[1];
                if (pageId && navItems[pageId]) {
                    const textElement = item.querySelector('.nav-item-text');
                    if (textElement) {
                        textElement.textContent = navItems[pageId];
                        // å¼ºåˆ¶åº”ç”¨å›ºå®šå®½åº¦æ ·å¼ï¼Œé˜²æ­¢æ–‡æœ¬æ’‘å¤§ä¾§è¾¹æ 
                        textElement.style.width = '180px';
                        textElement.style.maxWidth = '180px';
                        textElement.style.overflow = 'hidden';
                        textElement.style.textOverflow = 'ellipsis';
                        textElement.style.whiteSpace = 'nowrap';
                    }
                }
            });
            
            // å¼ºåˆ¶å›ºå®šä¾§è¾¹æ å®½åº¦
            const sidebar = document.querySelector('.sidebar');
            if (sidebar) {
                sidebar.style.width = '280px';
                sidebar.style.minWidth = '280px';
                sidebar.style.maxWidth = '280px';
                sidebar.style.flexShrink = '0';
            }
        }

        function initSidebarEnglish() {
            const saved = localStorage.getItem('sidebarEnglish') === 'true';
            const toggle = document.getElementById('sidebarEnglishToggle');
            if (toggle) {
                toggle.checked = saved;
                window.sidebarEnglishMode = saved;
                if (saved) {
                    window.updateSidebarToEnglish();
                }
            }
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            addMessage(message, 'user');
            input.value = '';
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const loadingMessage = addMessage('ğŸ¤” æ­£åœ¨æ€è€ƒä¸­...', 'assistant');
            
            try {
                // æ£€æŸ¥RAGç³»ç»ŸçŠ¶æ€
                if (window.ragSystemReady === false) {
                    loadingMessage.remove();
                    addMessage('âš ï¸ RAGç³»ç»Ÿå½“å‰ä¸å¯ç”¨ï¼Œè¯·ç­‰å¾…ç³»ç»Ÿå°±ç»ªæˆ–åˆ·æ–°é¡µé¢é‡è¯•ã€‚', 'assistant');
                    return;
                }
                
                // è°ƒç”¨RAGç³»ç»ŸAPI
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), RAG_CONFIG.timeout);
                
                const response = await fetch(`${RAG_CONFIG.baseURL}${RAG_CONFIG.endpoints.chat}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: message,
                        task_name: 'nexus_chat'
                    }),
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                const data = await response.json();
                
                // ç§»é™¤åŠ è½½æ¶ˆæ¯
                loadingMessage.remove();
                
                if (data.success) {
                    addMessage(data.response, 'assistant');
                } else {
                    addMessage(`âŒ æŠ±æ­‰ï¼Œå¤„ç†æ‚¨çš„é—®é¢˜æ—¶å‡ºç°é”™è¯¯: ${data.error}`, 'assistant');
                }
                
            } catch (error) {
                // ç§»é™¤åŠ è½½æ¶ˆæ¯
                loadingMessage.remove();
                
                console.error('APIè°ƒç”¨å¤±è´¥:', error);
                
                // æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
                let errorMessage = 'âŒ <strong>RAGç³»ç»Ÿè°ƒç”¨å¤±è´¥</strong><br>';
                
                if (error.name === 'AbortError') {
                    errorMessage += 'é”™è¯¯ç±»å‹: è¯·æ±‚è¶…æ—¶<br>';
                    errorMessage += `è¶…æ—¶æ—¶é—´: ${RAG_CONFIG.timeout/1000}ç§’<br>`;
                } else if (error.name === 'TypeError' && error.message.includes('fetch')) {
                    errorMessage += 'é”™è¯¯ç±»å‹: ç½‘ç»œè¿æ¥å¤±è´¥<br>';
                    errorMessage += `æœåŠ¡åœ°å€: ${RAG_CONFIG.baseURL}<br>`;
                } else if (error.name === 'SyntaxError') {
                    errorMessage += 'é”™è¯¯ç±»å‹: æœåŠ¡å™¨å“åº”æ ¼å¼é”™è¯¯<br>';
                } else {
                    errorMessage += `é”™è¯¯ç±»å‹: ${error.name}<br>`;
                }
                
                errorMessage += `é”™è¯¯è¯¦æƒ…: ${error.message}<br>`;
                errorMessage += `æ—¶é—´æˆ³: ${new Date().toLocaleString('zh-CN')}<br>`;
                errorMessage += '<br>ğŸ”§ <strong>å»ºè®®æ“ä½œ:</strong><br>';
                errorMessage += '1. æ£€æŸ¥ç½‘ç»œè¿æ¥<br>';
                errorMessage += '2. åˆ·æ–°é¡µé¢é‡è¯•<br>';
                errorMessage += '3. è”ç³»ç³»ç»Ÿç®¡ç†å‘˜<br>';
                
                addMessage(errorMessage, 'assistant');
                
                // æ ‡è®°ç³»ç»Ÿä¸ºä¸å¯ç”¨
                window.ragSystemReady = false;
            }
        }

        function addMessage(content, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const avatar = sender === 'user' ? 'ğŸ‘¤' : 'ğŸ§ ';
            messageDiv.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">${content}</div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // è‡ªåŠ¨ä¿å­˜èŠå¤©è®°å½•
            saveChatHistory();
            
            // è¿”å›æ¶ˆæ¯å…ƒç´ ï¼Œä»¥ä¾¿åç»­æ“ä½œ
            return messageDiv;
        }

        // åŠŸèƒ½èœå•æ§åˆ¶
        function toggleFunctionMenu() {
            const menu = document.getElementById('functionMenu');
            const btn = document.getElementById('functionBtn');
            
            if (menu.classList.contains('show')) {
                menu.classList.remove('show');
                btn.classList.remove('active');
            } else {
                menu.classList.add('show');
                btn.classList.add('active');
            }
        }

        // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('functionMenu');
            const btn = document.getElementById('functionBtn');
            
            if (!btn.contains(event.target) && !menu.contains(event.target)) {
                menu.classList.remove('show');
                btn.classList.remove('active');
            }
        });

        // åŠŸèƒ½èœå•é¡¹
        async function uploadFile() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '*/*'; // æ”¯æŒæ‰€æœ‰æ–‡ä»¶ç±»å‹
            input.multiple = true; // æ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼ 
            input.onchange = async function(e) {
                const files = Array.from(e.target.files);
                if (files.length === 0) return;
                
                // æ˜¾ç¤ºä¸Šä¼ çš„æ–‡ä»¶
                files.forEach(file => {
                    let icon = 'ğŸ“';
                    if (file.type.startsWith('image/')) {
                        icon = 'ğŸ–¼ï¸';
                    } else if (file.type.includes('pdf')) {
                        icon = 'ğŸ“„';
                    } else if (file.type.includes('document') || file.type.includes('word')) {
                        icon = 'ğŸ“';
                    } else if (file.name.endsWith('.md') || file.name.endsWith('.markdown')) {
                        icon = 'ğŸ“‹';
                    } else if (file.name.endsWith('.txt')) {
                        icon = 'ğŸ“„';
                    } else if (file.name.match(/\.(py|js|html|css|json|xml|yml|yaml)$/)) {
                        icon = 'ğŸ’»';
                    }
                    addMessage(`${icon} æ­£åœ¨ä¸Šä¼ æ–‡ä»¶: ${file.name}`, 'user');
                });
                
                // æ˜¾ç¤ºå¤„ç†çŠ¶æ€
                const processingMessage = addMessage('ğŸ“¤ æ­£åœ¨å¤„ç†æ–‡ä»¶ï¼Œè¯·ç¨ç­‰...', 'assistant');
                
                try {
                    // åˆ›å»ºFormData
                    const formData = new FormData();
                    files.forEach(file => {
                        formData.append('files', file);
                    });
                    
                    // è°ƒç”¨ä¸Šä¼ API
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), RAG_CONFIG.timeout * 2); // ä¸Šä¼ éœ€è¦æ›´é•¿æ—¶é—´
                    
                    const response = await fetch(`${RAG_CONFIG.baseURL}${RAG_CONFIG.endpoints.upload}`, {
                        method: 'POST',
                        body: formData,
                        signal: controller.signal
                    });
                    
                    clearTimeout(timeoutId);
                    
                    const data = await response.json();
                    
                    // ç§»é™¤å¤„ç†æ¶ˆæ¯
                    processingMessage.remove();
                    
                    if (data.success) {
                        addMessage(`âœ… ${data.message}ï¼ç°åœ¨å¯ä»¥å‘æˆ‘æé—®ç›¸å…³å†…å®¹äº†ã€‚`, 'assistant');
                    } else {
                        addMessage(`âŒ æ–‡ä»¶å¤„ç†å¤±è´¥: ${data.error}`, 'assistant');
                    }
                    
                } catch (error) {
                    // ç§»é™¤å¤„ç†æ¶ˆæ¯
                    processingMessage.remove();
                    
                    console.error('æ–‡ä»¶ä¸Šä¼ å¤±è´¥:', error);
                    addMessage('âŒ æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼Œè¯·ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œã€‚', 'assistant');
                }
            };
            input.click();
            toggleFunctionMenu();
        }



        function recordAudio() {
            addMessage('ğŸ¤ è¯­éŸ³è¾“å…¥åŠŸèƒ½å¼€å‘ä¸­...', 'user');
            setTimeout(() => {
                addMessage('è¯­éŸ³è¾“å…¥åŠŸèƒ½å³å°†ä¸Šçº¿ï¼Œæ•¬è¯·æœŸå¾…ï¼', 'assistant');
            }, 500);
            toggleFunctionMenu();
        }

        // é‡æ–°è¿æ¥RAGç³»ç»Ÿ
        async function reconnectRAG() {
            addMessage('ğŸ”„ æ­£åœ¨é‡æ–°è¿æ¥RAGç³»ç»Ÿ...', 'assistant');
            
            // é‡ç½®è¿æ¥çŠ¶æ€
            window.ragSystemReady = undefined;
            
            // é‡æ–°æµ‹è¯•è¿æ¥
            await testRAGConnection();
            
            toggleFunctionMenu();
        }

        async function clearChat() {
            try {
                // è°ƒç”¨æ¸…ç©ºAPI
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), RAG_CONFIG.timeout);
                
                const response = await fetch(`${RAG_CONFIG.baseURL}${RAG_CONFIG.endpoints.clear}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        task_name: 'nexus_chat'
                    }),
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                const data = await response.json();
                
                if (data.success) {
                    // æ¸…ç©ºå‰ç«¯èŠå¤©è®°å½•
                    const messagesContainer = document.getElementById('chatMessages');
                    messagesContainer.innerHTML = `
                        <div class="message">
                            <div class="message-avatar">ğŸ§ </div>
                            <div class="message-content">
                                ä½ å¥½ï¼æˆ‘æ˜¯RAGæ™ºèƒ½åŠ©æ‰‹ï¼Œå¯ä»¥å¸®ä½ åˆ†ææ–‡æ¡£ã€å›ç­”é—®é¢˜ã€‚<br><br>ğŸ“‹ æ”¯æŒæ ¼å¼ï¼šMarkdown (.md), æ–‡æœ¬ (.txt), ä»£ç æ–‡ä»¶ (.py, .js, .html, .css), é…ç½®æ–‡ä»¶ (.json, .xml, .yml) ç­‰<br><br>è¯·ä¸Šä¼ æ–‡æ¡£æˆ–ç›´æ¥æé—®ï¼
                            </div>
                        </div>
                    `;
                    
                    // æ¸…ç©ºæœ¬åœ°å­˜å‚¨
                    clearChatHistory();
                    
                    addMessage('âœ… èŠå¤©è®°å½•å·²æ¸…ç©º', 'assistant');
                } else {
                    addMessage(`âŒ æ¸…ç©ºå¤±è´¥: ${data.error}`, 'assistant');
                }
                
            } catch (error) {
                console.error('æ¸…ç©ºèŠå¤©è®°å½•å¤±è´¥:', error);
                addMessage('âŒ æ¸…ç©ºèŠå¤©è®°å½•å¤±è´¥ï¼Œè¯·ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œã€‚', 'assistant');
            }
            
            toggleFunctionMenu();
        }



        // RAGç³»ç»Ÿé…ç½® - åŠ¨æ€æ£€æµ‹æœåŠ¡å™¨åœ°å€
        const RAG_CONFIG = {
            baseURL: (() => {
                // å¦‚æœæ˜¯é€šè¿‡éš§é“è®¿é—®ï¼Œä¼˜å…ˆå°è¯•å·²çŸ¥çš„RAGéš§é“åœ°å€
                if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
                    // å½“å‰å·²å¯åŠ¨çš„RAGéš§é“åœ°å€
                    return 'https://webmasters-soup-pack-safer.trycloudflare.com';
                }
                // æœ¬åœ°å¼€å‘ç¯å¢ƒ
                return 'http://localhost:5000';
            })(),
            fallbackURLs: [
                'https://webmasters-soup-pack-safer.trycloudflare.com', // å½“å‰RAGéš§é“
                'http://localhost:5000',
                'http://127.0.0.1:5000',
                `${window.location.protocol}//${window.location.hostname}:5000`
            ],
            endpoints: {
                health: '/api/health',
                chat: '/api/chat',
                history: '/api/history',
                upload: '/api/upload',
                clear: '/api/clear'
            },
            timeout: 10000
        };

        // çŠ¶æ€æ¡†æ˜¾ç¤ºæ§åˆ¶
        let statusTimeout = null;
        
        // æ˜¾ç¤ºè¿æ¥çŠ¶æ€
        function showConnectionStatus() {
            const statusBar = document.getElementById('connectionStatus');
            statusBar.classList.add('show');
            
            // æ¸…é™¤ä¹‹å‰çš„è‡ªåŠ¨éšè—å®šæ—¶å™¨
            if (statusTimeout) {
                clearTimeout(statusTimeout);
                statusTimeout = null;
            }
        }
        
        // éšè—è¿æ¥çŠ¶æ€
        function hideConnectionStatus() {
            const statusBar = document.getElementById('connectionStatus');
            statusBar.classList.remove('show');
        }
        
        // è‡ªåŠ¨éšè—è¿æ¥çŠ¶æ€ï¼ˆä»…åœ¨æˆåŠŸæ—¶ï¼‰
        function autoHideConnectionStatus(delay = 3000) {
            if (statusTimeout) {
                clearTimeout(statusTimeout);
            }
            statusTimeout = setTimeout(() => {
                hideConnectionStatus();
            }, delay);
        }
        
        // æ›´æ–°è¿æ¥çŠ¶æ€æ˜¾ç¤º
        function updateConnectionStatus(status, message, details = '') {
            // åªåœ¨RAGç³»ç»Ÿé¡µé¢æ˜¾ç¤ºçŠ¶æ€æ¡†
            if (currentPage !== 'rag-system') {
                return;
            }
            
            const statusBar = document.getElementById('connectionStatus');
            const statusDot = statusBar.querySelector('.status-dot');
            const statusText = statusBar.querySelector('.status-text');
            const statusDetails = document.getElementById('statusDetails');
            
            // æ¸…é™¤æ‰€æœ‰çŠ¶æ€ç±»
            statusBar.className = 'connection-status show';
            
            switch (status) {
                case 'connecting':
                    statusBar.classList.add('warning');
                    statusDot.textContent = 'ğŸ”„';
                    showConnectionStatus();
                    break;
                case 'connected':
                    statusBar.classList.add('connected');
                    statusDot.textContent = 'âœ…';
                    showConnectionStatus();
                    // æˆåŠŸè¿æ¥å3ç§’è‡ªåŠ¨éšè—
                    autoHideConnectionStatus(3000);
                    break;
                case 'error':
                    statusBar.classList.add('error');
                    statusDot.textContent = 'âŒ';
                    showConnectionStatus();
                    // é”™è¯¯çŠ¶æ€ä¸è‡ªåŠ¨éšè—ï¼Œéœ€è¦ç”¨æˆ·æ‰‹åŠ¨å…³é—­
                    break;
                case 'warning':
                    statusBar.classList.add('warning');
                    statusDot.textContent = 'âš ï¸';
                    showConnectionStatus();
                    break;
            }
            
            statusText.textContent = message;
            statusDetails.textContent = details;
        }

        // å°è¯•è¿æ¥åˆ°æŒ‡å®šURL
        async function tryConnectToURL(baseURL) {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), RAG_CONFIG.timeout);
            
            try {
                const response = await fetch(`${baseURL}${RAG_CONFIG.endpoints.health}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                if (response.ok) {
                    const data = await response.json();
                    return { success: true, data, baseURL };
                } else {
                    return { success: false, error: `HTTP ${response.status}: ${response.statusText}`, baseURL };
                }
            } catch (error) {
                clearTimeout(timeoutId);
                return { success: false, error: error.message, baseURL };
            }
        }

        // æµ‹è¯•RAGç³»ç»Ÿè¿æ¥
        async function testRAGConnection() {
            console.log('ğŸ” å¼€å§‹æµ‹è¯•RAGç³»ç»Ÿè¿æ¥...');
            updateConnectionStatus('connecting', 'æ­£åœ¨è¿æ¥RAGç³»ç»Ÿ...', 'å°è¯•å¤šä¸ªæœåŠ¡å™¨åœ°å€...');
            
            // æ„å»ºè¦å°è¯•çš„URLåˆ—è¡¨
            const urlsToTry = [RAG_CONFIG.baseURL, ...RAG_CONFIG.fallbackURLs.filter(url => url !== RAG_CONFIG.baseURL)];
            
            console.log('ğŸ”— å°è¯•è¿æ¥çš„URL:', urlsToTry);
            
            for (let i = 0; i < urlsToTry.length; i++) {
                const currentURL = urlsToTry[i];
                console.log(`ğŸ”„ å°è¯•è¿æ¥ ${i + 1}/${urlsToTry.length}: ${currentURL}`);
                
                updateConnectionStatus('connecting', 
                    `æ­£åœ¨è¿æ¥RAGç³»ç»Ÿ... (${i + 1}/${urlsToTry.length})`,
                    `å½“å‰å°è¯•: ${currentURL}`
                );
                
                const result = await tryConnectToURL(currentURL);
                
                if (result.success) {
                    console.log('âœ… RAGç³»ç»Ÿè¿æ¥æˆåŠŸ:', result.data);
                    
                    // æ›´æ–°é…ç½®ä¸ºæˆåŠŸçš„URL
                    RAG_CONFIG.baseURL = result.baseURL;
                    
                    // æ›´æ–°çŠ¶æ€æ 
                    updateConnectionStatus('connected', 
                        `RAGç³»ç»Ÿå·²å°±ç»ª (${result.data.chat_history_count}æ¡å†å², ${result.data.documents_count}ä¸ªæ–‡æ¡£)`,
                        `æœåŠ¡åœ°å€: ${result.baseURL}\nç³»ç»Ÿæ—¶é—´: ${new Date(result.data.timestamp).toLocaleString('zh-CN')}`
                    );
                    
                    // æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€ï¼ˆä»…åœ¨é¦–æ¬¡è¿æ¥æ—¶ï¼‰
                    if (window.ragSystemReady === undefined) {
                        addMessage(`ğŸ‰ <strong>RAGç³»ç»Ÿå·²å°±ç»ª</strong><br>
                        ğŸ“Š èŠå¤©å†å²: ${result.data.chat_history_count} æ¡<br>
                        ğŸ“š æ–‡æ¡£æ•°é‡: ${result.data.documents_count} ä¸ª<br>
                        ğŸ•’ ç³»ç»Ÿæ—¶é—´: ${new Date(result.data.timestamp).toLocaleString('zh-CN')}<br>
                        ğŸŒ æœåŠ¡åœ°å€: ${result.baseURL}<br>
                        ğŸ’¡ æ‚¨å¯ä»¥å¼€å§‹ä¸AIåŠ©æ‰‹å¯¹è¯äº†ï¼`, 'assistant');
                    }
                    
                    // è®¾ç½®è¿æ¥çŠ¶æ€
                    window.ragSystemReady = true;
                    return;
                }
                
                console.log(`âŒ è¿æ¥å¤±è´¥ ${currentURL}:`, result.error);
            }
            
            // æ‰€æœ‰URLéƒ½å¤±è´¥äº†
            console.error('âŒ æ‰€æœ‰RAGæœåŠ¡å™¨åœ°å€éƒ½æ— æ³•è¿æ¥');
            
            updateConnectionStatus('error', 'RAGç³»ç»Ÿè¿æ¥å¤±è´¥', 
                `å·²å°è¯• ${urlsToTry.length} ä¸ªæœåŠ¡å™¨åœ°å€\n\nğŸ”§ å¿«é€Ÿè§£å†³æ–¹æ¡ˆ:\n1. è¿è¡Œ: python start_rag_tunnel.py\n2. ç­‰å¾…éš§é“URLæ˜¾ç¤º\n3. åˆ·æ–°é¡µé¢æˆ–ç‚¹å‡»é‡æ–°è¿æ¥\n\nç‚¹å‡» âœ• å…³é—­æ­¤æç¤º`
            );
            
            let errorMessage = 'âš ï¸ <strong>RAGç³»ç»Ÿè¿æ¥å¼‚å¸¸</strong><br>';
            errorMessage += 'é”™è¯¯ç±»å‹: ç½‘ç»œè¿æ¥å¤±è´¥<br>';
            errorMessage += `é”™è¯¯è¯¦æƒ…: æ— æ³•è¿æ¥åˆ°ä»»ä½•RAGæœåŠ¡å™¨<br>`;
            errorMessage += `å°è¯•çš„åœ°å€: ${urlsToTry.join(', ')}<br>`;
            errorMessage += `å½“å‰é¡µé¢: ${window.location.href}<br>`;
            errorMessage += '<br>ğŸš€ <strong>å¿«é€Ÿè§£å†³æ–¹æ¡ˆ:</strong><br>';
            errorMessage += '1. åœ¨ç»ˆç«¯è¿è¡Œ: <code>python start_rag_tunnel.py</code><br>';
            errorMessage += '2. ç­‰å¾…æ˜¾ç¤ºéš§é“URL<br>';
            errorMessage += '3. åˆ·æ–°é¡µé¢æˆ–ç‚¹å‡»åŠŸèƒ½èœå•ä¸­çš„"é‡æ–°è¿æ¥"<br>';
            errorMessage += '<br>ğŸ”§ <strong>å…¶ä»–è§£å†³æ–¹æ¡ˆ:</strong><br>';
            errorMessage += 'â€¢ æœ¬åœ°è®¿é—®: <a href="http://localhost:52943/systems/nexus/nexus-dashboard-restored.html" target="_blank">http://localhost:52943</a><br>';
            errorMessage += 'â€¢ æ‰‹åŠ¨å¯åŠ¨éš§é“: <code>cloudflared tunnel --url http://localhost:5000</code><br>';
            errorMessage += 'â€¢ æŸ¥çœ‹è¯¦ç»†æŒ‡å—: TUNNEL_ACCESS_GUIDE.md<br>';
            errorMessage += '<br>ğŸ’¡ æ‚¨ä»å¯ä»¥ä½¿ç”¨å…¶ä»–åŠŸèƒ½ï¼Œä½†AIå¯¹è¯åŠŸèƒ½æš‚æ—¶ä¸å¯ç”¨ã€‚';
            
            addMessage(errorMessage, 'assistant');
            
            // è®¾ç½®è¿æ¥çŠ¶æ€
            window.ragSystemReady = false;
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initTheme();
            
            // æ¢å¤èŠå¤©è®°å½•
            setTimeout(() => {
                const restored = loadChatHistory();
                if (restored) {
                    console.log('ğŸ“š èŠå¤©è®°å½•å·²æ¢å¤');
                }
            }, 500); // å»¶è¿Ÿ500msç¡®ä¿DOMå®Œå…¨åŠ è½½
            
            // æµ‹è¯•RAGç³»ç»Ÿè¿æ¥
            setTimeout(() => {
                testRAGConnection();
            }, 1000);
            
            // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–ï¼ˆä»…åœ¨autoæ¨¡å¼ä¸‹ï¼‰
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
                if (currentTheme === 'auto') {
                    const themeToggle = document.getElementById('themeToggle');
                    if (e.matches) {
                        document.documentElement.removeAttribute('data-theme');
                        themeToggle.textContent = 'ğŸŒ™';
                    } else {
                        document.documentElement.setAttribute('data-theme', 'light');
                        themeToggle.textContent = 'â˜€ï¸';
                    }
                }
            });
        });

        // å›è½¦å‘é€æ¶ˆæ¯
        document.addEventListener('DOMContentLoaded', function() {
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }
        });

        // ğŸŒ å›½é™…åŒ–åˆå§‹åŒ–
        function initializeI18n() {
            try {
                console.log('ğŸŒ å¼€å§‹åˆå§‹åŒ–å›½é™…åŒ–ç³»ç»Ÿ...');
                console.log('ğŸŒ LANGUAGESå¯¹è±¡å­˜åœ¨:', typeof LANGUAGES !== 'undefined');
                console.log('ğŸŒ initI18nå‡½æ•°å­˜åœ¨:', typeof initI18n === 'function');
                
                i18n = initI18n();
                if (i18n) {
                    console.log('ğŸŒ å›½é™…åŒ–ç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸ');
                    console.log('ğŸŒ å½“å‰è¯­è¨€:', i18n.getCurrentLanguage());
                    
                    // æ›´æ–°è¯­è¨€åˆ‡æ¢å™¨æ˜¾ç¤º
                    updateLanguageSwitcher();
                    
                    // ç›‘å¬è¯­è¨€å˜åŒ–
                    i18n.addObserver((language) => {
                        console.log(`ğŸŒ è¯­è¨€åˆ‡æ¢åˆ°: ${language}`);
                        updateLanguageSwitcher();
                        updatePageTitle();
                    });
                } else {
                    console.warn('ğŸŒ å›½é™…åŒ–ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥');
                }
            } catch (error) {
                console.error('ğŸŒ å›½é™…åŒ–ç³»ç»Ÿåˆå§‹åŒ–é”™è¯¯:', error);
            }
        }

        // æ›´æ–°è¯­è¨€åˆ‡æ¢å™¨æ˜¾ç¤º
        function updateLanguageSwitcher() {
            if (!i18n) return;
            
            const currentLang = i18n.getCurrentLanguage();
            const langData = LANGUAGES[currentLang];
            
            if (langData) {
                const flagElement = document.querySelector('.language-flag');
                const nameElement = document.querySelector('.language-name');
                
                if (flagElement) flagElement.textContent = langData.flag;
                if (nameElement) nameElement.textContent = langData.name;
                
                // æ›´æ–°ä¸‹æ‹‰é€‰é¡¹çš„æ¿€æ´»çŠ¶æ€
                document.querySelectorAll('.language-option').forEach(option => {
                    option.classList.remove('active');
                    if (option.dataset.lang === currentLang) {
                        option.classList.add('active');
                    }
                });
                
                // åŒæ­¥è®¾ç½®é¡µé¢çš„è¯­è¨€é€‰æ‹©å™¨
                const languageSelect = document.getElementById('languageSelect');
                if (languageSelect) {
                    languageSelect.value = currentLang;
                }
            }
        }
        
        // ä»è®¾ç½®é¡µé¢åˆ‡æ¢è¯­è¨€
        function changeLanguageFromSettings(language) {
            if (i18n) {
                console.log(`ğŸŒ ä»è®¾ç½®é¡µé¢åˆ‡æ¢è¯­è¨€åˆ°: ${language}`);
                
                // ç«‹å³å¼ºåˆ¶å›ºå®šå®½åº¦
                forceSidebarWidth();
                
                i18n.switchLanguage(language);
                
                // è¯­è¨€åˆ‡æ¢åå¤šæ¬¡å¼ºåˆ¶å›ºå®šä¾§è¾¹æ å®½åº¦
                setTimeout(forceSidebarWidth, 50);
                setTimeout(forceSidebarWidth, 200);
                setTimeout(forceSidebarWidth, 500);
            }
        }

        // æ›´æ–°é¡µé¢æ ‡é¢˜
        function updatePageTitle() {
            if (!i18n) return;
            
            const titleElement = document.querySelector('.page-title');
            if (titleElement && currentPage) {
                // ç›´æ¥ä½¿ç”¨currentPageä½œä¸ºkeyï¼Œå› ä¸ºi18né…ç½®ä¸­çš„keyå°±æ˜¯é¡µé¢ID
                const titleKey = `titles.${currentPage.replace('-', '')}`;
                const translatedTitle = i18n.t(titleKey, pageTitles[currentPage] || 'Dashboard');
                titleElement.textContent = translatedTitle;
            }
        }

        // ğŸ“± ç§»åŠ¨ç«¯èœå•åŠŸèƒ½
        function initializeMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebar = document.querySelector('.sidebar');
            const mobileOverlay = document.getElementById('mobileOverlay');
            
            if (!mobileMenuBtn || !sidebar || !mobileOverlay) return;
            
            // æ±‰å ¡èœå•ç‚¹å‡»äº‹ä»¶
            mobileMenuBtn.addEventListener('click', function() {
                const isOpen = sidebar.classList.contains('mobile-open');
                
                if (isOpen) {
                    closeMobileMenu();
                } else {
                    openMobileMenu();
                }
            });
            
            // é®ç½©å±‚ç‚¹å‡»å…³é—­èœå•
            mobileOverlay.addEventListener('click', closeMobileMenu);
            
            // ä¾§è¾¹æ å¯¼èˆªé¡¹ç‚¹å‡»åå…³é—­èœå•
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    if (window.innerWidth <= 768) {
                        setTimeout(closeMobileMenu, 150); // å»¶è¿Ÿå…³é—­ï¼Œè®©é¡µé¢åˆ‡æ¢åŠ¨ç”»å…ˆæ‰§è¡Œ
                    }
                });
            });
            
            // ç›‘å¬çª—å£å¤§å°å˜åŒ–
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    closeMobileMenu();
                }
            });
        }

        // æ‰“å¼€ç§»åŠ¨ç«¯èœå•
        function openMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebar = document.querySelector('.sidebar');
            const mobileOverlay = document.getElementById('mobileOverlay');
            
            mobileMenuBtn.classList.add('active');
            sidebar.classList.add('mobile-open');
            mobileOverlay.style.display = 'block';
            
            // å»¶è¿Ÿæ˜¾ç¤ºé®ç½©å±‚åŠ¨ç”»
            setTimeout(() => {
                mobileOverlay.classList.add('show');
            }, 10);
            
            // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
            document.body.style.overflow = 'hidden';
        }

        // å…³é—­ç§»åŠ¨ç«¯èœå•
        function closeMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebar = document.querySelector('.sidebar');
            const mobileOverlay = document.getElementById('mobileOverlay');
            
            mobileMenuBtn.classList.remove('active');
            sidebar.classList.remove('mobile-open');
            mobileOverlay.classList.remove('show');
            
            // å»¶è¿Ÿéšè—é®ç½©å±‚
            setTimeout(() => {
                mobileOverlay.style.display = 'none';
            }, 300);
            
            // æ¢å¤èƒŒæ™¯æ»šåŠ¨
            document.body.style.overflow = '';
        }

        // ğŸŒ è¯­è¨€åˆ‡æ¢åŠŸèƒ½
        function initializeLanguageSwitcher() {
            const languageBtn = document.getElementById('languageBtn');
            const languageDropdown = document.getElementById('languageDropdown');
            const languageOptions = document.querySelectorAll('.language-option');
            
            if (!languageBtn || !languageDropdown) return;
            
            // è¯­è¨€æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            languageBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                languageDropdown.classList.toggle('show');
            });
            
            // è¯­è¨€é€‰é¡¹ç‚¹å‡»äº‹ä»¶
            languageOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const selectedLang = this.dataset.lang;
                    console.log('ğŸŒ ç‚¹å‡»è¯­è¨€é€‰é¡¹:', selectedLang);
                    console.log('ğŸŒ i18nå¯¹è±¡å­˜åœ¨:', !!i18n);
                    
                    if (i18n && selectedLang) {
                        console.log('ğŸŒ å¼€å§‹åˆ‡æ¢è¯­è¨€åˆ°:', selectedLang);
                        
                        // ç«‹å³å¼ºåˆ¶å›ºå®šå®½åº¦
                        forceSidebarWidth();
                        
                        i18n.switchLanguage(selectedLang);
                        
                        // è¯­è¨€åˆ‡æ¢åå¤šæ¬¡å¼ºåˆ¶å›ºå®šä¾§è¾¹æ å®½åº¦
                        setTimeout(forceSidebarWidth, 50);
                        setTimeout(forceSidebarWidth, 200);
                        setTimeout(forceSidebarWidth, 500);
                    } else {
                        console.error('ğŸŒ è¯­è¨€åˆ‡æ¢å¤±è´¥ - i18n:', !!i18n, 'selectedLang:', selectedLang);
                    }
                    
                    languageDropdown.classList.remove('show');
                });
            });
            
            // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­ä¸‹æ‹‰èœå•
            document.addEventListener('click', function() {
                languageDropdown.classList.remove('show');
            });
            
            // é˜»æ­¢ä¸‹æ‹‰èœå•å†…éƒ¨ç‚¹å‡»äº‹ä»¶å†’æ³¡
            languageDropdown.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }

        // ğŸ”™ æ™ºèƒ½è¿”å›åŠŸèƒ½
        function goBack() {
            // æ£€æŸ¥æ˜¯å¦æœ‰å†å²è®°å½•ä¸”ä¸æ˜¯ä»å¤–éƒ¨é“¾æ¥ç›´æ¥è¿›å…¥
            if (window.history.length > 1 && document.referrer && 
                document.referrer.includes(window.location.hostname)) {
                window.history.back();
            } else {
                // å¦‚æœæ²¡æœ‰åˆé€‚çš„å†å²è®°å½•ï¼Œè¿”å›åˆ°ä¸»é¡µé¢æˆ–Dashboard
                showPage('dashboard');
            }
        }

        // ğŸ“± ç§»åŠ¨ç«¯é€‚é…ä¼˜åŒ–
        function initializeMobileOptimizations() {
            // è®¾ç½®CSSè‡ªå®šä¹‰å±æ€§ç”¨äºç§»åŠ¨ç«¯é«˜åº¦è®¡ç®—
            function setAppHeight() {
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--app-height', `${window.innerHeight}px`);
            }
            
            // åˆå§‹è®¾ç½®
            setAppHeight();
            
            // ç›‘å¬çª—å£å¤§å°å˜åŒ–ï¼ˆå¤„ç†ç§»åŠ¨ç«¯åœ°å€æ éšè—/æ˜¾ç¤ºï¼‰
            window.addEventListener('resize', setAppHeight);
            window.addEventListener('orientationchange', () => {
                setTimeout(setAppHeight, 100);
            });
            
            // ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ–
            if ('ontouchstart' in window) {
                document.body.classList.add('touch-device');
                
                // é˜²æ­¢åŒå‡»ç¼©æ”¾
                let lastTouchEnd = 0;
                document.addEventListener('touchend', function(event) {
                    const now = (new Date()).getTime();
                    if (now - lastTouchEnd <= 300) {
                        event.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);
            }
            
            // ç§»åŠ¨ç«¯é”®ç›˜å¤„ç†
            if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                const viewport = document.querySelector('meta[name=viewport]');
                if (viewport) {
                    // è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹æ—¶è°ƒæ•´è§†å£
                    document.addEventListener('focusin', function(e) {
                        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                            viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
                            // å»¶è¿Ÿé‡æ–°è®¡ç®—è§†çª—é«˜åº¦ï¼Œç­‰å¾…é”®ç›˜å¼¹å‡º
                            setTimeout(setRealViewportHeight, 300);
                        }
                    });
                    
                    // è¾“å…¥æ¡†å¤±å»ç„¦ç‚¹æ—¶æ¢å¤è§†å£
                    document.addEventListener('focusout', function(e) {
                        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                            viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover');
                            // å»¶è¿Ÿé‡æ–°è®¡ç®—è§†çª—é«˜åº¦ï¼Œç­‰å¾…é”®ç›˜æ”¶èµ·
                            setTimeout(setRealViewportHeight, 300);
                        }
                    });
                }
                
                // é¢å¤–çš„è§†è§‰è§†çª—å˜åŒ–ç›‘å¬ï¼ˆiOS Safariä¸“ç”¨ï¼‰
                if (window.visualViewport) {
                    window.visualViewport.addEventListener('resize', setRealViewportHeight);
                }
            }
        }

        // ğŸ”— æ˜¾ç¤ºé¡¹ç›®è¯´æ˜é¡µé¢
        function goToProjectInfo() {
            showPage('project-info');
        }

        // ğŸ”™ æ™ºèƒ½è¿”å›æŒ‰é’®å¤„ç†
        function handleBackButton() {
            if (currentPage === 'dashboard') {
                // åœ¨Dashboardé¡µé¢ï¼Œç‚¹å‡»â†è¿›å…¥é¡¹ç›®è¯´æ˜
                showPage('project-info');
            } else if (currentPage === 'project-info') {
                // åœ¨é¡¹ç›®è¯´æ˜é¡µé¢ï¼Œç‚¹å‡»â†è¿”å›Dashboard
                goBack();
            } else {
                // å…¶ä»–é¡µé¢ï¼Œä½¿ç”¨æ™ºèƒ½è¿”å›
                goBack();
            }
        }

        // ğŸš€ ä¸»åˆå§‹åŒ–å‡½æ•°
        // åŠ¨æ€è§†çª—é«˜åº¦å¤„ç†
        function setRealViewportHeight() {
            // è·å–çœŸå®çš„è§†çª—é«˜åº¦ï¼ˆæ’é™¤æµè§ˆå™¨UIï¼‰
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--real-vh', `${vh}px`);
        }

        // åˆå§‹è®¾ç½®
        setRealViewportHeight();

        // ç›‘å¬çª—å£å¤§å°å˜åŒ–å’Œæ–¹å‘å˜åŒ–
        window.addEventListener('resize', setRealViewportHeight);
        window.addEventListener('orientationchange', function() {
            // å»¶è¿Ÿæ‰§è¡Œï¼Œç­‰å¾…æ–¹å‘å˜åŒ–å®Œæˆ
            setTimeout(setRealViewportHeight, 100);
        });

        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ NEXUS Research Workstation åˆå§‹åŒ–ä¸­...');
            
            // ç¡®ä¿è§†çª—é«˜åº¦æ­£ç¡®è®¾ç½®
            setRealViewportHeight();
            
            // åˆå§‹åŒ–å›½é™…åŒ–ç³»ç»Ÿ
            initializeI18n();
            
            // åˆå§‹åŒ–ç§»åŠ¨ç«¯èœå•
            initializeMobileMenu();
            
            // åˆå§‹åŒ–è¯­è¨€åˆ‡æ¢å™¨
            initializeLanguageSwitcher();
            
            // åˆå§‹åŒ–ç§»åŠ¨ç«¯ä¼˜åŒ–
            initializeMobileOptimizations();
            
            // åˆå§‹åŒ–ä¾§è¾¹æ è‹±æ–‡å›ºå®šåŠŸèƒ½
            initSidebarEnglish();
            
            // å¼ºåˆ¶å›ºå®šä¾§è¾¹æ å®½åº¦
            setTimeout(forceSidebarWidth, 500);
            
            // ç›‘æ§ä¾§è¾¹æ å®½åº¦å˜åŒ– - é«˜é¢‘ç›‘æ§
            const sidebar = document.querySelector('.sidebar');
            if (sidebar) {
                // é«˜é¢‘æ£€æŸ¥å¹¶ä¿®å¤å®½åº¦
                setInterval(function() {
                    const currentWidth = sidebar.offsetWidth;
                    if (currentWidth !== 280) {
                        console.log('ğŸš¨ æ£€æµ‹åˆ°å®½åº¦å¼‚å¸¸:', currentWidth, 'ç«‹å³ä¿®å¤!');
                        forceSidebarWidth();
                    }
                }, 100); // æ¯100msæ£€æŸ¥ä¸€æ¬¡
                
                // ç›‘å¬DOMå˜åŒ–
                const observer = new MutationObserver(function() {
                    forceSidebarWidth();
                });
                
                observer.observe(sidebar, {
                    attributes: true,
                    childList: true,
                    subtree: true
                });
                
                // ç›‘å¬çª—å£å¤§å°å˜åŒ–
                window.addEventListener('resize', forceSidebarWidth);
            }
            
            console.log('âœ… NEXUS Research Workstation åˆå§‹åŒ–å®Œæˆ');
            
            // æµ‹è¯•è¯­è¨€åˆ‡æ¢åŠŸèƒ½
            setTimeout(() => {
                console.log('ğŸ§ª æµ‹è¯•è¯­è¨€åˆ‡æ¢åŠŸèƒ½...');
                console.log('ğŸ§ª i18nå¯¹è±¡:', i18n);
                console.log('ğŸ§ª LANGUAGESå¯¹è±¡:', typeof LANGUAGES !== 'undefined' ? 'loaded' : 'not loaded');
                if (i18n) {
                    console.log('ğŸ§ª å½“å‰è¯­è¨€:', i18n.getCurrentLanguage());
                    console.log('ğŸ§ª æ”¯æŒçš„è¯­è¨€:', Object.keys(LANGUAGES));
                }
            }, 1000);
        });
    </script>

    <!-- è¿æ¥çŠ¶æ€æ‚¬æµ®æ¡† -->
    <div class="connection-status" id="connectionStatus">
        <div class="status-header">
            <div class="status-title">ğŸ”§ ç³»ç»ŸçŠ¶æ€</div>
            <button class="status-close" onclick="hideConnectionStatus()">âœ•</button>
        </div>
        <div class="status-content" id="statusIndicator">
            <span class="status-dot">ğŸ”„</span>
            <span class="status-text">æ­£åœ¨è¿æ¥RAGç³»ç»Ÿ...</span>
        </div>
        <div class="status-details" id="statusDetails"></div>
    </div>

</body>
</html>