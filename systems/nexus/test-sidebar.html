<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>侧边栏宽度测试</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            display: flex;
            height: 100vh;
        }

        /* 强制固定侧边栏宽度 */
        .sidebar {
            width: 280px !important;
            min-width: 280px !important;
            max-width: 280px !important;
            background: #f0f0f0;
            border-right: 2px solid red;
            flex-shrink: 0 !important;
            box-sizing: border-box !important;
            padding: 20px;
            position: relative;
        }

        .sidebar::before {
            content: "280px FIXED";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: lime;
            color: black;
            text-align: center;
            font-weight: bold;
            padding: 5px;
        }

        .nav-item {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .nav-item-text {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .main-content {
            flex: 1;
            padding: 20px;
            background: #fff;
        }

        .language-btn {
            padding: 10px 20px;
            margin: 10px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .language-btn:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <h3>NEXUS</h3>
        <div class="nav-item">
            <div class="nav-item-text" data-i18n="nav.dashboard">Dashboard</div>
        </div>
        <div class="nav-item">
            <div class="nav-item-text" data-i18n="nav.nexus">NEXUSリモートコントロール</div>
        </div>
        <div class="nav-item">
            <div class="nav-item-text" data-i18n="nav.rag">RAGシステム</div>
        </div>
        <div class="nav-item">
            <div class="nav-item-text" data-i18n="nav.ai">AI Assistant</div>
        </div>
    </div>

    <div class="main-content">
        <h1>侧边栏宽度测试</h1>
        <p>当前侧边栏宽度应该固定为280px</p>
        
        <button class="language-btn" onclick="changeToJapanese()">切换到日语</button>
        <button class="language-btn" onclick="changeToChinese()">切换到中文</button>
        <button class="language-btn" onclick="changeToEnglish()">切换到英语</button>
        
        <div id="info" style="margin-top: 20px; padding: 10px; background: #f8f9fa; border-radius: 4px;">
            <p>侧边栏当前宽度: <span id="width-display">-</span>px</p>
        </div>
    </div>

    <script>
        const translations = {
            'zh-CN': {
                'nav.dashboard': 'Dashboard',
                'nav.nexus': 'NEXUS远程控制',
                'nav.rag': 'RAG系统',
                'nav.ai': 'AI助手'
            },
            'ja-JP': {
                'nav.dashboard': 'Dashboard',
                'nav.nexus': 'NEXUSリモートコントロール',
                'nav.rag': 'RAGシステム',
                'nav.ai': 'AIアシスタント'
            },
            'en-US': {
                'nav.dashboard': 'Dashboard',
                'nav.nexus': 'NEXUS Remote Control',
                'nav.rag': 'RAG System',
                'nav.ai': 'AI Assistant'
            }
        };

        function updateTexts(lang) {
            console.log('切换语言到:', lang);
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang] && translations[lang][key]) {
                    element.textContent = translations[lang][key];
                    console.log('更新文本:', key, '->', translations[lang][key]);
                }
            });
            
            // 强制固定宽度
            forceSidebarWidth();
        }

        function forceSidebarWidth() {
            const sidebar = document.querySelector('.sidebar');
            if (sidebar) {
                console.log('强制设置侧边栏宽度前:', sidebar.offsetWidth);
                sidebar.style.width = '280px';
                sidebar.style.minWidth = '280px';
                sidebar.style.maxWidth = '280px';
                sidebar.style.flexShrink = '0';
                console.log('强制设置侧边栏宽度后:', sidebar.offsetWidth);
                updateWidthDisplay();
            }
        }

        function updateWidthDisplay() {
            const sidebar = document.querySelector('.sidebar');
            const display = document.getElementById('width-display');
            if (sidebar && display) {
                display.textContent = sidebar.offsetWidth;
            }
        }

        function changeToJapanese() {
            updateTexts('ja-JP');
        }

        function changeToChinese() {
            updateTexts('zh-CN');
        }

        function changeToEnglish() {
            updateTexts('en-US');
        }

        // 页面加载完成后
        document.addEventListener('DOMContentLoaded', function() {
            console.log('页面加载完成');
            forceSidebarWidth();
            
            // 定期更新宽度显示
            setInterval(updateWidthDisplay, 500);
        });
    </script>
</body>
</html>