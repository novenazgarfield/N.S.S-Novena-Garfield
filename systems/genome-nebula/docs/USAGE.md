# ğŸ§¬ Genome Jigsaw ä½¿ç”¨æŒ‡å—

## ğŸ“‹ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

é¦–å…ˆåˆ›å»ºå¹¶æ¿€æ´» conda ç¯å¢ƒï¼š

```bash
# åˆ›å»ºç¯å¢ƒ
conda env create -f environment.yml

# æ¿€æ´»ç¯å¢ƒ
conda activate genome-jigsaw
```

### 2. æ•°æ®å‡†å¤‡

ç¡®ä¿æ‚¨çš„åŸå§‹æµ‹åºæ•°æ®æŒ‰ä»¥ä¸‹æ ¼å¼å‘½åï¼š
- `sample1_R1.fastq.gz` å’Œ `sample1_R2.fastq.gz`
- `sample2_R1.fastq.gz` å’Œ `sample2_R2.fastq.gz`
- æˆ–è€… `sample1_1.fastq.gz` å’Œ `sample1_2.fastq.gz`

### 3. è¿è¡Œåˆ†æ

```bash
# åŸºæœ¬ç”¨æ³•
./run_genome_jigsaw.sh /path/to/your/fastq/files

# è‡ªå®šä¹‰å‚æ•°
./run_genome_jigsaw.sh -o my_results -t 16 -m 32G /path/to/your/fastq/files
```

## ğŸ”§ å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `-o, --output` | è¾“å‡ºç›®å½• | `results` |
| `-t, --threads` | çº¿ç¨‹æ•° | è‡ªåŠ¨æ£€æµ‹ |
| `-m, --memory` | å†…å­˜é™åˆ¶ | `16G` |
| `-h, --help` | æ˜¾ç¤ºå¸®åŠ© | - |

## ğŸ“Š è¾“å‡ºç»“æœ

åˆ†æå®Œæˆåï¼Œç»“æœå°†ä¿å­˜åœ¨ä»¥ä¸‹ç›®å½•ç»“æ„ä¸­ï¼š

```
results/
â”œâ”€â”€ 01_qc/                      # è´¨é‡æ§åˆ¶ç»“æœ
â”‚   â”œâ”€â”€ multiqc_raw_data.html   # åŸå§‹æ•°æ®è´¨é‡æŠ¥å‘Š
â”‚   â””â”€â”€ *.html, *.zip           # FastQC æŠ¥å‘Š
â”œâ”€â”€ 02_clean/                   # æ•°æ®æ¸…æ´—ç»“æœ
â”‚   â”œâ”€â”€ *_clean_R1.fastq.gz     # æ¸…æ´—åçš„ R1 æ–‡ä»¶
â”‚   â”œâ”€â”€ *_clean_R2.fastq.gz     # æ¸…æ´—åçš„ R2 æ–‡ä»¶
â”‚   â”œâ”€â”€ *_fastp.html            # fastp æŠ¥å‘Š
â”‚   â””â”€â”€ qc/                     # æ¸…æ´—åæ•°æ®è´¨é‡æ§åˆ¶
â”œâ”€â”€ 03_assembly/                # åŸºå› ç»„ç»„è£…ç»“æœ
â”‚   â”œâ”€â”€ *_contigs.fasta         # ç»„è£…çš„åŸºå› ç»„
â”‚   â”œâ”€â”€ assembly_stats.txt      # ç»„è£…ç»Ÿè®¡ä¿¡æ¯
â”‚   â””â”€â”€ */                      # å„æ ·æœ¬çš„è¯¦ç»†ç»„è£…ç»“æœ
â”œâ”€â”€ 04_annotation/              # åŸºå› ç»„æ³¨é‡Šç»“æœ
â”‚   â”œâ”€â”€ annotation_stats.txt    # æ³¨é‡Šç»Ÿè®¡ä¿¡æ¯
â”‚   â””â”€â”€ */                      # å„æ ·æœ¬çš„æ³¨é‡Šç»“æœ
â”‚       â”œâ”€â”€ *.gff               # åŸºå› æ³¨é‡Šæ–‡ä»¶
â”‚       â”œâ”€â”€ *.faa               # è›‹ç™½è´¨åºåˆ—
â”‚       â””â”€â”€ *.ffn               # åŸºå› åºåˆ—
â”œâ”€â”€ 05_pangenome/               # æ³›åŸºå› ç»„åˆ†æç»“æœ
â”‚   â”œâ”€â”€ gene_presence_absence.csv # åŸºå› å­˜åœ¨/ç¼ºå¤±çŸ©é˜µ
â”‚   â”œâ”€â”€ pangenome_stats.txt     # æ³›åŸºå› ç»„ç»Ÿè®¡
â”‚   â”œâ”€â”€ core_gene_alignment.aln # æ ¸å¿ƒåŸºå› æ¯”å¯¹
â”‚   â””â”€â”€ *.Rtab                  # Roary è¾“å‡ºæ–‡ä»¶
â”œâ”€â”€ 06_phylogenetics/           # ç³»ç»Ÿå‘è‚²åˆ†æç»“æœ
â”‚   â”œâ”€â”€ core_genes_tree.treefile # ç³»ç»Ÿå‘è‚²æ ‘
â”‚   â”œâ”€â”€ core_genes_mafft.aln    # MAFFT æ¯”å¯¹ç»“æœ
â”‚   â”œâ”€â”€ tree_stats.txt          # æ ‘ç»Ÿè®¡ä¿¡æ¯
â”‚   â””â”€â”€ core_genes_tree.*       # IQ-TREE è¾“å‡ºæ–‡ä»¶
â”œâ”€â”€ 07_screening/               # åŸºå› ç­›é€‰ç»“æœ
â”‚   â”œâ”€â”€ screening_summary.txt   # ç­›é€‰ç»“æœæ±‡æ€»
â”‚   â”œâ”€â”€ resfinder/              # è€è¯åŸºå› ç­›é€‰
â”‚   â”œâ”€â”€ card/                   # CARD æ•°æ®åº“ç­›é€‰
â”‚   â”œâ”€â”€ vfdb/                   # æ¯’åŠ›åŸºå› ç­›é€‰
â”‚   â”œâ”€â”€ plasmidfinder/          # è´¨ç²’åŸºå› ç­›é€‰
â”‚   â””â”€â”€ ncbi/                   # NCBI æ•°æ®åº“ç­›é€‰
â”œâ”€â”€ GENOME_JIGSAW_REPORT.txt    # æœ€ç»ˆåˆ†ææŠ¥å‘Š
â””â”€â”€ genome_jigsaw_*.log         # è¯¦ç»†æ—¥å¿—æ–‡ä»¶
```

## ğŸ” å…³é”®ç»“æœæ–‡ä»¶

### 1. è´¨é‡æ§åˆ¶æŠ¥å‘Š
- **æ–‡ä»¶**: `01_qc/multiqc_raw_data.html`
- **å†…å®¹**: åŸå§‹æ•°æ®è´¨é‡è¯„ä¼°ï¼ŒåŒ…æ‹¬åºåˆ—è´¨é‡ã€GCå«é‡ã€é‡å¤åºåˆ—ç­‰

### 2. åŸºå› ç»„ç»„è£…ç»Ÿè®¡
- **æ–‡ä»¶**: `03_assembly/assembly_stats.txt`
- **å†…å®¹**: æ¯ä¸ªæ ·æœ¬çš„ç»„è£…è´¨é‡æŒ‡æ ‡ï¼ˆN50ã€æ€»é•¿åº¦ã€contigæ•°é‡ç­‰ï¼‰

### 3. æ³›åŸºå› ç»„åˆ†æ
- **æ–‡ä»¶**: `05_pangenome/gene_presence_absence.csv`
- **å†…å®¹**: æ‰€æœ‰æ ·æœ¬çš„åŸºå› å­˜åœ¨/ç¼ºå¤±çŸ©é˜µï¼Œç”¨äºæ¯”è¾ƒåŸºå› ç»„å­¦åˆ†æ

### 4. ç³»ç»Ÿå‘è‚²æ ‘
- **æ–‡ä»¶**: `06_phylogenetics/core_genes_tree.treefile`
- **å†…å®¹**: åŸºäºæ ¸å¿ƒåŸºå› çš„ç³»ç»Ÿå‘è‚²æ ‘ï¼Œå¯ç”¨äºè¿›åŒ–åˆ†æ

### 5. åŸºå› ç­›é€‰ç»“æœ
- **æ–‡ä»¶**: `07_screening/*_summary.txt`
- **å†…å®¹**: è€è¯åŸºå› ã€æ¯’åŠ›åŸºå› ã€è´¨ç²’åŸºå› ç­‰çš„ç­›é€‰ç»“æœ

## ğŸ§¬ ä¸‹æ¸¸åˆ†æå»ºè®®

### 1. åˆ†å­æ¼”åŒ–ç ”ç©¶
```bash
# ä½¿ç”¨ R æˆ– Python åˆ†æç³»ç»Ÿå‘è‚²æ ‘
# è®¡ç®—è¿›åŒ–è·ç¦»
# åˆ†æåŸºå› è·å¾—/ä¸¢å¤±æ¨¡å¼
```

### 2. ç‰¹å¼‚æ€§é¶ç‚¹ç­›é€‰
```bash
# åˆ†ææ ¸å¿ƒåŸºå› ç»„
# ç­›é€‰ä¿å®ˆåºåˆ—
# è®¾è®¡ç‰¹å¼‚æ€§å¼•ç‰©/æ¢é’ˆ
```

### 3. æ¯”è¾ƒåŸºå› ç»„å­¦
```bash
# åˆ†æåŸºå› ç»„ç»“æ„å˜å¼‚
# è¯†åˆ«æ°´å¹³åŸºå› è½¬ç§»
# æ¯”è¾ƒä¸åŒèŒæ ªç‰¹å¾
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å†…å­˜è¦æ±‚**: å»ºè®®è‡³å°‘ 16GB å†…å­˜ï¼Œå¤§åŸºå› ç»„æˆ–å¤šæ ·æœ¬åˆ†æéœ€è¦æ›´å¤šå†…å­˜
2. **å­˜å‚¨ç©ºé—´**: ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ï¼ˆé€šå¸¸æ˜¯åŸå§‹æ•°æ®çš„ 5-10 å€ï¼‰
3. **è¿è¡Œæ—¶é—´**: å®Œæ•´åˆ†æå¯èƒ½éœ€è¦å‡ å°æ—¶åˆ°å‡ å¤©ï¼Œå–å†³äºæ ·æœ¬æ•°é‡å’ŒåŸºå› ç»„å¤§å°
4. **æ•°æ®è´¨é‡**: ä½è´¨é‡çš„æµ‹åºæ•°æ®å¯èƒ½å½±å“ä¸‹æ¸¸åˆ†æç»“æœ

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç¯å¢ƒé—®é¢˜**
   ```bash
   # é‡æ–°åˆ›å»ºç¯å¢ƒ
   conda env remove -n genome-jigsaw
   conda env create -f environment.yml
   ```

2. **å†…å­˜ä¸è¶³**
   ```bash
   # å‡å°‘çº¿ç¨‹æ•°æˆ–å¢åŠ å†…å­˜é™åˆ¶
   ./run_genome_jigsaw.sh -t 4 -m 8G /path/to/data
   ```

3. **ç£ç›˜ç©ºé—´ä¸è¶³**
   ```bash
   # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
   rm -rf results/*/tmp/
   ```

4. **å·¥å…·ç‰ˆæœ¬é—®é¢˜**
   ```bash
   # æ£€æŸ¥å·¥å…·ç‰ˆæœ¬
   conda list
   ```

### æ—¥å¿—åˆ†æ
è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯è¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼š
```bash
tail -f results/genome_jigsaw_*.log
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ä¸­çš„é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥è¾“å…¥æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤ç³»ç»Ÿèµ„æºæ˜¯å¦å……è¶³
4. è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿ

---

*Genome Jigsaw v1.0.0 - è®©åŸºå› ç»„åˆ†æå˜å¾—ç®€å•ï¼* ğŸ§¬âœ¨