<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📱 手机访问测试</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }
        
        .card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .status {
            font-size: 1.2rem;
            margin: 20px 0;
        }
        
        .link-card {
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            text-decoration: none;
            color: white;
            display: block;
            transition: all 0.3s ease;
        }
        
        .link-card:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .device-info {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 20px;
        }
        
        .qr-code {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .test-button {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>📱 RAG智能对话</h1>
            <p>手机访问测试页面</p>
            
            <div class="status" id="status">
                🔍 正在检测设备...
            </div>
            
            <div class="device-info" id="device-info">
                <!-- 设备信息将在这里显示 -->
            </div>
        </div>
        
        <div class="card">
            <h2>🌐 访问链接</h2>
            
            <a href="https://que-rising-brief-guild.trycloudflare.com" class="link-card" target="_blank">
                <strong>🚀 主要地址</strong><br>
                <small>que-rising-brief-guild.trycloudflare.com</small>
            </a>
            
            <div style="margin: 20px 0;">
                <strong>🔐 访问密码:</strong> <code style="background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 5px;">rag2024</code>
            </div>
        </div>
        
        <div class="card">
            <h2>📋 二维码扫描</h2>
            <div class="qr-code">
                <p style="color: #333; margin-bottom: 10px;">扫描下方二维码直接访问</p>
                <div style="font-size: 100px; line-height: 1;">📱</div>
                <p style="color: #666; font-size: 0.8rem;">二维码图片: rag_qrcode.png</p>
            </div>
        </div>
        
        <div class="card">
            <h2>🔧 连接测试</h2>
            
            <button class="test-button" onclick="testConnection()">
                🌐 测试网络连接
            </button>
            
            <button class="test-button" onclick="testFeatures()">
                📱 测试浏览器功能
            </button>
            
            <div id="test-results" style="margin-top: 20px; text-align: left;">
                <!-- 测试结果将在这里显示 -->
            </div>
        </div>
        
        <div class="card">
            <h2>💡 使用提示</h2>
            <div style="text-align: left; font-size: 0.9rem;">
                <p>✅ <strong>推荐操作:</strong></p>
                <ul>
                    <li>添加到主屏幕获得App体验</li>
                    <li>使用横屏模式获得更大视野</li>
                    <li>启用浏览器的"桌面版网站"</li>
                </ul>
                
                <p>🔧 <strong>遇到问题:</strong></p>
                <ul>
                    <li>清除浏览器缓存重试</li>
                    <li>切换WiFi/4G网络</li>
                    <li>更新浏览器到最新版本</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // 检测设备信息
        function detectDevice() {
            const ua = navigator.userAgent;
            const statusEl = document.getElementById('status');
            const deviceInfoEl = document.getElementById('device-info');
            
            let deviceType = '💻 桌面设备';
            let browser = '未知浏览器';
            let os = '未知系统';
            
            // 检测设备类型
            if (/Mobile|Android|iPhone|iPad/.test(ua)) {
                deviceType = '📱 移动设备';
            }
            
            // 检测浏览器
            if (ua.includes('Chrome')) browser = 'Chrome';
            else if (ua.includes('Safari')) browser = 'Safari';
            else if (ua.includes('Firefox')) browser = 'Firefox';
            else if (ua.includes('Edge')) browser = 'Edge';
            
            // 检测操作系统
            if (ua.includes('iPhone')) os = 'iOS';
            else if (ua.includes('Android')) os = 'Android';
            else if (ua.includes('Windows')) os = 'Windows';
            else if (ua.includes('Mac')) os = 'macOS';
            else if (ua.includes('Linux')) os = 'Linux';
            
            statusEl.innerHTML = `✅ 设备检测完成`;
            deviceInfoEl.innerHTML = `
                <strong>设备类型:</strong> ${deviceType}<br>
                <strong>浏览器:</strong> ${browser}<br>
                <strong>操作系统:</strong> ${os}<br>
                <strong>屏幕尺寸:</strong> ${window.innerWidth} × ${window.innerHeight}<br>
                <strong>网络状态:</strong> ${navigator.onLine ? '🌐 在线' : '📴 离线'}
            `;
        }
        
        // 测试网络连接
        async function testConnection() {
            const resultsEl = document.getElementById('test-results');
            resultsEl.innerHTML = '🔍 正在测试连接...';
            
            const tests = [
                {
                    name: '主要地址',
                    url: 'https://que-rising-brief-guild.trycloudflare.com',
                    timeout: 5000
                },
                {
                    name: '本地服务',
                    url: 'http://localhost:51657',
                    timeout: 3000
                }
            ];
            
            let results = '<strong>🔗 连接测试结果:</strong><br><br>';
            
            for (const test of tests) {
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), test.timeout);
                    
                    const response = await fetch(test.url, {
                        method: 'HEAD',
                        signal: controller.signal,
                        mode: 'no-cors'
                    });
                    
                    clearTimeout(timeoutId);
                    results += `✅ ${test.name}: 连接成功<br>`;
                } catch (error) {
                    results += `❌ ${test.name}: 连接失败 (${error.message})<br>`;
                }
            }
            
            resultsEl.innerHTML = results;
        }
        
        // 测试浏览器功能
        function testFeatures() {
            const resultsEl = document.getElementById('test-results');
            
            const features = [
                { name: 'JavaScript', test: () => true },
                { name: 'LocalStorage', test: () => typeof(Storage) !== 'undefined' },
                { name: 'Fetch API', test: () => typeof(fetch) !== 'undefined' },
                { name: 'Service Worker', test: () => 'serviceWorker' in navigator },
                { name: '文件上传', test: () => typeof(FileReader) !== 'undefined' },
                { name: '触摸支持', test: () => 'ontouchstart' in window },
                { name: '地理位置', test: () => 'geolocation' in navigator },
                { name: '摄像头', test: () => 'mediaDevices' in navigator }
            ];
            
            let results = '<strong>📱 浏览器功能测试:</strong><br><br>';
            
            features.forEach(feature => {
                const supported = feature.test();
                results += `${supported ? '✅' : '❌'} ${feature.name}: ${supported ? '支持' : '不支持'}<br>`;
            });
            
            resultsEl.innerHTML = results;
        }
        
        // 页面加载完成后执行
        window.addEventListener('load', () => {
            detectDevice();
        });
        
        // 监听网络状态变化
        window.addEventListener('online', () => {
            document.getElementById('status').innerHTML = '🌐 网络已连接';
        });
        
        window.addEventListener('offline', () => {
            document.getElementById('status').innerHTML = '📴 网络已断开';
        });
    </script>
</body>
</html>